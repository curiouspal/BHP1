---
title: "BHP2-Dec8_2014"
author: "Anirban Pal"
date: "12/08/2014"
output: html_document
---


```{r}
setwd("~/Documents/BoulderHousingPartnersData")
library("foreign")
library("ggplot2")
library("plyr") ## For desc()
library("grid") ## For unit

ph <- read.csv("ph.txt")
s8 <- read.csv("s8.txt") 
all <- read.csv("Merged.csv") 
```

For Public Housing residents, let us look at the cross-tabulations by location ID (1 to 5) for different questions. 


```{r, echo=TRUE}
ftable(xtabs(~factor(Q1, exclude=NULL)+location, data=ph)) # Prior housing.
ftable(xtabs(~factor(Q2, exclude=NULL)+location, data=ph)) # How long housing assistance needed

# Barriers to housing 
ftable(xtabs(~factor(Q3_1, exclude=NULL)+location, data=ph)) # Not having a paying job
ftable(xtabs(~factor(Q3_2, exclude=NULL)+location, data=ph)) # Low wages or not enough income
ftable(xtabs(~factor(Q3_3, exclude=NULL)+location, data=ph)) # High basic expenses
ftable(xtabs(~factor(Q3_4, exclude=NULL)+location, data=ph)) # Health issues
ftable(xtabs(~factor(Q3_5, exclude=NULL)+location, data=ph)) # High Child care expense
ftable(xtabs(~factor(Q3_6, exclude=NULL)+location, data=ph)) # Being a single parent/head of household
ftable(xtabs(~factor(Q3_7, exclude=NULL)+location, data=ph)) # Bad credit history 
ftable(xtabs(~factor(Q3_8, exclude=NULL)+location, data=ph)) # Not having the knowledge/skills
ftable(xtabs(~factor(Q3_9, exclude=NULL)+location, data=ph)) # High cost of housing 

ftable(xtabs(~factor(Q4, exclude=NULL)+location, data=ph)) # Late rent
ftable(xtabs(~factor(Q5, exclude=NULL)+location, data=ph)) # Employment status
ftable(xtabs(~factor(Q6, exclude=NULL)+location, data=ph)) # Want/need more hours
ftable(xtabs(~factor(Q7, exclude=NULL)+location, data=ph)) # Skills qualify for better paying job

# Following are some of the barriers to employment.
ftable(xtabs(~factor(Q8_1_1, exclude=NULL)+location, data=ph))  # Being a student
ftable(xtabs(~factor(Q8_1_2, exclude=NULL)+location, data=ph))  # Health problems
ftable(xtabs(~factor(Q8_1_3, exclude=NULL)+location, data=ph))	# Lack of education or skills 
ftable(xtabs(~factor(Q8_1_4, exclude=NULL)+location, data=ph))	# Lack of work history
ftable(xtabs(~factor(Q8_1_5, exclude=NULL)+location, data=ph))	# Transportation 
ftable(xtabs(~factor(Q8_1_6, exclude=NULL)+location, data=ph))	# English proficiency 
ftable(xtabs(~factor(Q8_1_7, exclude=NULL)+location, data=ph))	# Discrimination
ftable(xtabs(~factor(Q8_1_8, exclude=NULL)+location, data=ph))	# Having child care responsibilities
ftable(xtabs(~factor(Q8_1_9, exclude=NULL)+location, data=ph))	# Experiencing domestic violence 
ftable(xtabs(~factor(Q8_1_10, exclude=NULL)+location, data=ph))	# Having a criminal record
ftable(xtabs(~factor(Q8_1_11, exclude=NULL)+location, data=ph))	# Not enough time to find a job or work more hours
ftable(xtabs(~factor(Q8_1_12, exclude=NULL)+location, data=ph))	# Not knowing how to find a job
ftable(xtabs(~factor(Q8_1_13, exclude=NULL)+location, data=ph))	# Tight job market, bad economy
ftable(xtabs(~factor(Q8_1_14, exclude=NULL)+location, data=ph))	# Immigration status


# Following are some of the barriers to working more hours.
ftable(xtabs(~factor(Q8_2_1, exclude=NULL)+location, data=ph))  # Being a student
ftable(xtabs(~factor(Q8_2_2, exclude=NULL)+location, data=ph))  # Health problems
ftable(xtabs(~factor(Q8_2_3, exclude=NULL)+location, data=ph))	# Lack of education or skills 
ftable(xtabs(~factor(Q8_2_4, exclude=NULL)+location, data=ph))	# Lack of work history
ftable(xtabs(~factor(Q8_2_5, exclude=NULL)+location, data=ph))	# Transportation 
ftable(xtabs(~factor(Q8_2_6, exclude=NULL)+location, data=ph))	# English proficiency 
ftable(xtabs(~factor(Q8_2_7, exclude=NULL)+location, data=ph))	# Discrimination
ftable(xtabs(~factor(Q8_2_8, exclude=NULL)+location, data=ph))	# Having child care responsibilities
ftable(xtabs(~factor(Q8_2_9, exclude=NULL)+location, data=ph))	# Experiencing domestic violence 
ftable(xtabs(~factor(Q8_2_10, exclude=NULL)+location, data=ph))	# Having a criminal record
ftable(xtabs(~factor(Q8_2_11, exclude=NULL)+location, data=ph))	# Not enough time to find a job or work more hours
ftable(xtabs(~factor(Q8_2_12, exclude=NULL)+location, data=ph))	# Not knowing how to find a job
ftable(xtabs(~factor(Q8_2_13, exclude=NULL)+location, data=ph))	# Tight job market, bad economy
ftable(xtabs(~factor(Q8_2_14, exclude=NULL)+location, data=ph))	# Immigration status

ftable(xtabs(~factor(Q9, exclude=NULL)+location, data=ph)) # Income ran out in the last three months.

# Very hard to pay for...
ftable(xtabs(~factor(Q10_1, exclude=NULL)+location, data=ph)) # Buying food
ftable(xtabs(~factor(Q10_2, exclude=NULL)+location, data=ph))	# Having reliable housing
ftable(xtabs(~factor(Q10_3, exclude=NULL)+location, data=ph))	# Getting health care for myself and my family 
ftable(xtabs(~factor(Q10_4, exclude=NULL)+location, data=ph))	# Having reliable transportation
ftable(xtabs(~factor(Q10_5, exclude=NULL)+location, data=ph))	# Having reliable child care
ftable(xtabs(~factor(Q10_6, exclude=NULL)+location, data=ph))	# Making debt payments 
ftable(xtabs(~factor(Q10_7, exclude=NULL)+location, data=ph))	# Paying utilities
ftable(xtabs(~factor(Q10_8, exclude=NULL)+location, data=ph))	# Saving money



ftable(xtabs(~factor(Q11, exclude=NULL)+location, data=ph)) # Q11  Cut/skip meal last 3 months?
ftable(xtabs(~factor(Q12, exclude=NULL)+location, data=ph)) # Q12	Food sources except income?

# Q13	Food sources
ftable(xtabs(~factor(Q13_1, exclude=NULL)+location, data=ph)) # Q13_1	Food assistance (food stamps)
ftable(xtabs(~factor(Q13_2, exclude=NULL)+location, data=ph)) # Q13_2	Food banks
ftable(xtabs(~factor(Q13_3, exclude=NULL)+location, data=ph)) # Q13_3	Friends
ftable(xtabs(~factor(Q13_4, exclude=NULL)+location, data=ph)) # Q13_4	Neighbors
ftable(xtabs(~factor(Q13_5, exclude=NULL)+location, data=ph)) # Q13_5	Family members


ftable(xtabs(~factor(Q14, exclude=NULL)+location, data=ph)) # Q14	Problems getting food?

# Q15	Food barriers
ftable(xtabs(~factor(Q15_1, exclude=NULL)+location, data=ph)) # Q15_1	Lack of income
ftable(xtabs(~factor(Q15_2, exclude=NULL)+location, data=ph)) # Q15_2	Lack of easy access to the stores 
ftable(xtabs(~factor(Q15_3, exclude=NULL)+location, data=ph)) # Q15_3	Lack of time to get to the stores
ftable(xtabs(~factor(Q15_4, exclude=NULL)+location, data=ph)) # Q15_4	Lack of knowledge to find nutritious food

# Q16	Transportation - satisfaction
ftable(xtabs(~factor(Q16_1, exclude=NULL)+location, data=ph)) # Q16_1	My own car
ftable(xtabs(~factor(Q16_2, exclude=NULL)+location, data=ph)) # Q16_2	Carpool 
ftable(xtabs(~factor(Q16_3, exclude=NULL)+location, data=ph)) # Q16_3	Bus
ftable(xtabs(~factor(Q16_4, exclude=NULL)+location, data=ph)) # Q16_4	Motorcycle
ftable(xtabs(~factor(Q16_5, exclude=NULL)+location, data=ph)) # Q16_5	Bicycle
ftable(xtabs(~factor(Q16_6, exclude=NULL)+location, data=ph)) # Q16_6	Walking

ftable(xtabs(~factor(Q17, exclude=NULL)+location, data=ph)) # Q17	Hard to get to appts./work last 2 weeks?

# Q18	Transportation barriers
ftable(xtabs(~factor(Q18_1, exclude=NULL)+location, data=ph)) # Q18_1	Live far from work, grocery store, etc.
ftable(xtabs(~factor(Q18_2, exclude=NULL)+location, data=ph)) # Q18_2	Personal or family members’ health
ftable(xtabs(~factor(Q18_3, exclude=NULL)+location, data=ph)) # Q18_3	Bus stops are too far
ftable(xtabs(~factor(Q18_4, exclude=NULL)+location, data=ph)) # Q18_4	Bus schedule is not convenient
ftable(xtabs(~factor(Q18_5, exclude=NULL)+location, data=ph)) # Q18_5	Bus fares
ftable(xtabs(~factor(Q18_6, exclude=NULL)+location, data=ph)) # Q18_6	Gas costs
ftable(xtabs(~factor(Q18_7, exclude=NULL)+location, data=ph)) # Q18_7	Don’t have a bike
ftable(xtabs(~factor(Q18_8, exclude=NULL)+location, data=ph)) # Q18_8	Don’t have a car
ftable(xtabs(~factor(Q18_9, exclude=NULL)+location, data=ph)) # Q18_9	Don’t have a ride
ftable(xtabs(~factor(Q18_10, exclude=NULL)+location, data=ph)) # Q18_10	Don’t know how to get to places/not familiar with the area/don’t have directions

ftable(xtabs(~factor(Q19, exclude=NULL)+location, data=ph)) # Q19	Children <13?
ftable(xtabs(~factor(Q20, exclude=NULL)+location, data=ph)) # Q20	Childcare sufficient?

# Q21	Evaluate childcare
ftable(xtabs(~factor(Q21_1, exclude=NULL)+location, data=ph)) # Q21_1	Accessibility
ftable(xtabs(~factor(Q21_2, exclude=NULL)+location, data=ph)) # Q21_2	Quality
ftable(xtabs(~factor(Q21_3, exclude=NULL)+location, data=ph)) # Q21_3	Affordability

# Q22	Barriers to childcare?
ftable(xtabs(~factor(Q22_1, exclude=NULL)+location, data=ph)) # Q22_1	Accessibility
ftable(xtabs(~factor(Q22_2, exclude=NULL)+location, data=ph)) # Q22_2	Quality
ftable(xtabs(~factor(Q22_3, exclude=NULL)+location, data=ph)) # Q22_3	Affordability

# Q23	Help in last 3 months
ftable(xtabs(~factor(Q23_1, exclude=NULL)+location, data=ph)) # Q23_1	Church
ftable(xtabs(~factor(Q23_2, exclude=NULL)+location, data=ph)) # Q23_2	Charitable organization
ftable(xtabs(~factor(Q23_3, exclude=NULL)+location, data=ph)) # Q23_3	Local support group
ftable(xtabs(~factor(Q23_4, exclude=NULL)+location, data=ph)) # Q23_4	Family
ftable(xtabs(~factor(Q23_5, exclude=NULL)+location, data=ph)) # Q23_5	Friends/Neighbors

# Q24	Network Barriers
ftable(xtabs(~factor(Q24_1, exclude=NULL)+location, data=ph)) # Q24_1	Living far from family and friends
ftable(xtabs(~factor(Q24_2, exclude=NULL)+location, data=ph)) # Q24_2	Living far from community organizations
ftable(xtabs(~factor(Q24_3, exclude=NULL)+location, data=ph)) # Q24_3	Living far from people who share my interests 
ftable(xtabs(~factor(Q24_4, exclude=NULL)+location, data=ph)) # Q24_4	Cannot afford social events
ftable(xtabs(~factor(Q24_5, exclude=NULL)+location, data=ph)) # Q24_5	Not having enough time for social events
ftable(xtabs(~factor(Q24_6, exclude=NULL)+location, data=ph)) # Q24_6	Don’t know how to find community organizations/social events

# Q25	Types of support
ftable(xtabs(~factor(Q25_1, exclude=NULL)+location, data=ph)) # Q25_1	SNAP (Food Stamps)
ftable(xtabs(~factor(Q25_2, exclude=NULL)+location, data=ph)) # Q25_2	Medicaid
ftable(xtabs(~factor(Q25_3, exclude=NULL)+location, data=ph)) # Q25_3	CHP+ (Colorado Health Plan Plus)
ftable(xtabs(~factor(Q25_4, exclude=NULL)+location, data=ph)) # Q25_4	LEAP (Energy assistance)
ftable(xtabs(~factor(Q25_5, exclude=NULL)+location, data=ph)) # Q25_5	Free/reduced lunch
ftable(xtabs(~factor(Q25_6, exclude=NULL)+location, data=ph)) # Q25_6	TANF (Temporary Aid to Needy Families)
ftable(xtabs(~factor(Q25_7, exclude=NULL)+location, data=ph)) # Q25_7	CCAP (Child Care Assistance Program)

ftable(xtabs(~factor(Q26, exclude=NULL)+location, data=ph)) # Q26	Legal
	
# Q27	Barriers to resolving legal issues
ftable(xtabs(~factor(Q27_1, exclude=NULL)+location, data=ph)) # Q27_1	Don’t know how to access appropriate legal assistance
ftable(xtabs(~factor(Q27_2, exclude=NULL)+location, data=ph)) # Q27_2	Don’t have money to pay for appropriate legal assistance
ftable(xtabs(~factor(Q27_3, exclude=NULL)+location, data=ph)) # Q27_3	Don’t trust that legal assistance will help me
ftable(xtabs(~factor(Q27_4, exclude=NULL)+location, data=ph)) # Q27_4	Don’t know how to effectively communicate (language barrier)

ftable(xtabs(~factor(Q28, exclude=NULL)+location, data=ph)) # Q28	Health Insurance
	
ftable(xtabs(~factor(Q29, exclude=NULL)+location, data=ph)) # Q29	How would you rate your current health?
ftable(xtabs(~factor(Q30_1, exclude=NULL)+location, data=ph)) # Q30	Where do you go for primary health care?

ftable(xtabs(~factor(Q31, exclude=NULL)+location, data=ph)) # Q31	medical problem and not go to a doctor?
ftable(xtabs(~factor(Q32, exclude=NULL)+location, data=ph)) # Q32	highest level of education you have completed? 

ftable(xtabs(~factor(Q33, exclude=NULL)+location, data=ph)) # Q33	vocational qualification?

ftable(xtabs(~factor(Q34, exclude=NULL)+location, data=ph)) # Q34	Are you planning to advance your education or skills?

# Q35	Barriers for you to advance your education or skills? 
ftable(xtabs(~factor(Q35_1, exclude=NULL)+location, data=ph)) # Q35_1	Lack of time or energy
ftable(xtabs(~factor(Q35_2, exclude=NULL)+location, data=ph)) # Q35_2	Cost
ftable(xtabs(~factor(Q35_3, exclude=NULL)+location, data=ph)) # Q35_3	Responsibility for children
ftable(xtabs(~factor(Q35_4, exclude=NULL)+location, data=ph)) # Q35_4	Lack of interest/motivation
ftable(xtabs(~factor(Q35_5, exclude=NULL)+location, data=ph)) # Q35_5	Lack of study skills
ftable(xtabs(~factor(Q35_6, exclude=NULL)+location, data=ph)) # Q35_6	No place at home to study
ftable(xtabs(~factor(Q35_7, exclude=NULL)+location, data=ph)) # Q35_7	Lack of transportation
ftable(xtabs(~factor(Q35_8, exclude=NULL)+location, data=ph)) # Q35_8	Don’t know which type of education would help me get a better paying job
ftable(xtabs(~factor(Q35_9, exclude=NULL)+location, data=ph)) # Q35_9	Lack of English proficiency       
ftable(xtabs(~factor(Q35_10, exclude=NULL)+location, data=ph)) # Q35_10	Personal or family issues
ftable(xtabs(~factor(Q35_11, exclude=NULL)+location, data=ph)) # Q35_11	Health issues
ftable(xtabs(~factor(Q35_12, exclude=NULL)+location, data=ph)) # Q35_12	Immigration status

ftable(xtabs(~factor(Q36_1, exclude=NULL)+location, data=ph)) # Self assessment Housing
ftable(xtabs(~factor(Q36_2, exclude=NULL)+location, data=ph)) # Self assessment Employment 
ftable(xtabs(~factor(Q36_3, exclude=NULL)+location, data=ph)) # Self assessment Income
ftable(xtabs(~factor(Q36_4, exclude=NULL)+location, data=ph)) # Self assessment Food
ftable(xtabs(~factor(Q36_5, exclude=NULL)+location, data=ph)) # Self assessment Transportation
ftable(xtabs(~factor(Q36_6, exclude=NULL)+location, data=ph)) # Self assessment Child care
ftable(xtabs(~factor(Q36_7, exclude=NULL)+location, data=ph)) # self assessment Support Networks
ftable(xtabs(~factor(Q36_8, exclude=NULL)+location, data=ph)) # Self assessment Legal
ftable(xtabs(~factor(Q36_9, exclude=NULL)+location, data=ph)) # Self assessment Health
ftable(xtabs(~factor(Q36_10, exclude=NULL)+location, data=ph)) # Self assessment Education
ftable(xtabs(~factor(Q36_11, exclude=NULL)+location, data=ph)) # Self assessment Immigration status


```

```{r, echo=TRUE}
all$Q1 <- ordered(all$Q1,
                levels = c("I owned my home", "I lived in private market rental housing (including student housing)", "I lived in subsidized housing (for example, Section 8, Public Housing)", "I lived with family and friends", "I was homeless"),
                labels = c("Owned my home", "Market rental", "Subsidized housing", "With family/friends", "Was homeless"))

ggplot(all, aes(Q1, fill=PH_or_S8, use="complete.obs")) + geom_bar(position='dodge') + theme_set(theme_grey(base_size = 18)) + coord_flip()



ggplot(Q1merged, aes(PH_or_S8, Freq, fill=Q1, order=desc(Q1))) + geom_bar(stat="identity", width=0.5) + labs(x="", y="Percent", title="Where were you living before you began receiving housing
assistance from Boulder Housing Partners?") + theme(plot.title = element_text(size=20, face="bold", vjust=3), axis.text.x = element_text(angle = 90, hjust = 1))

ggplot(as.data.frame(prop.table(xtabs(~Q1, data=s8))*100), aes(Q1, Freq)) + geom_bar(stat="identity") + geom_text(aes(label=round(Freq, 2)), hjust=1, colour="white") + coord_flip()
ggplot(as.data.frame(prop.table(xtabs(~Q1, data=ph))*100), aes(Q1, Freq)) + geom_bar(stat="identity") + geom_text(aes(label=round(Freq, 2)), hjust=1, colour="white") + coord_flip()

ggplot(all, aes(Q1, fill=PH_or_S8, use="complete.obs")) + geom_bar(position='dodge') + theme_set(theme_grey(base_size = 18)) + coord_flip()

lbls <- paste(names(table(s8$Q1)), "\n", table(s8$Q1), sep="")
pie(table(s8$Q1), labels = lbls, 
    main="Pie Chart of S8 responses to Q1")

lbls <- paste(names(table(ph$Q1)), "\n", table(ph$Q1), sep="")
pie(table(ph$Q1), labels = lbls, 
    main="Pie Chart of PH responses to Q1")

ddply(all, "PH_or_S8", transform, percent_count = count / sum(Weight) * 100)


##################### Plotting frequency percentages. Q1
all$Q1 <- ordered(all$Q1,
                levels = c("I owned my home", "I lived in private market rental housing (including student housing)", "I lived in subsidized housing (for example, Section 8, Public Housing)", "I lived with family and friends", "I was homeless"),
                labels = c("Owned my home", "Market rental", "Subsidized housing", "With family/friends", "Was homeless"))

x <- as.data.frame(prop.table(xtabs(~Q1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q1merged <- rbind(x, y)
Q1merged$PH_or_S8 <- as.factor(Q1merged$PH_or_S8)
for(i in 1:length(Q1merged$Freq)) Q1merged$Freq[i] <- round(Q1merged$Freq[i], 2)
summary(Q1merged)

ggplot(Q1merged, aes(as.factor(Q1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Where were you living before you\nbegan receiving housing assistance from BHP?") + 
   geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=76)", "S8 (N=223)"))

summary(subset(all, PH_or_S8=="PH"))


                                                                                                                                                                                                          
#######################################################################



##################### Plotting frequency percentages. Q2
all$Q2 <- ordered(all$Q2,
                levels = c("For the next 6 months", "For the next 7 – 12 months", "For the next 1 – 2 years", "For the next 3 – 5 years", "For more than 5 years"),
                labels = c("<6 months", "7-12 months", "1-2 years", "3-5 years", ">5 years"))

x <- as.data.frame(prop.table(xtabs(~Q2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q2merged <- rbind(x, y)
Q2merged$PH_or_S8 <- as.factor(Q2merged$PH_or_S8)
for(i in 1:length(Q2merged$Freq)) Q2merged$Freq[i] <- round(Q2merged$Freq[i], 2)
summary(Q2merged)


ggplot(Q2merged, aes(Q2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How long do you expect to need housing assistance?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=79)", "S8 (N=243)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                        
#######################################################################



##################### Plotting frequency percentages. Q3_1
all$Q3_1 <- ordered(all$Q3_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_1merged <- rbind(x, y)
Q3_1merged$PH_or_S8 <- as.factor(Q3_1merged$PH_or_S8)
for(i in 1:length(Q3_1merged$Freq)) Q3_1merged$Freq[i] <- round(Q3_1merged$Freq[i], 2)
summary(Q3_1merged)

ggplot(Q3_1merged, aes(Q3_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not having a paying job a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=48)", "S8 (N=162)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_2
all$Q3_2 <- ordered(all$Q3_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_2merged <- rbind(x, y)
Q3_2merged$PH_or_S8 <- as.factor(Q3_2merged$PH_or_S8)
for(i in 1:length(Q3_2merged$Freq)) Q3_2merged$Freq[i] <- round(Q3_2merged$Freq[i], 0)
summary(Q3_2merged)

ggplot(Q3_2merged, aes(Q3_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Low wages or not enough income a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=75)", "S8 (N=225)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_3
all$Q3_3 <- ordered(all$Q3_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_3merged <- rbind(x, y)
Q3_3merged$PH_or_S8 <- as.factor(Q3_3merged$PH_or_S8)
for(i in 1:length(Q3_3merged$Freq)) Q3_3merged$Freq[i] <- round(Q3_3merged$Freq[i], 0)
summary(Q3_3merged)

ggplot(Q3_3merged, aes(Q3_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="High basic expenses, such as food, transportation,
health care, etc. a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=192)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################


##################### Plotting frequency percentages. Q3_4
all$Q3_4 <- ordered(all$Q3_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_4merged <- rbind(x, y)
Q3_4merged$PH_or_S8 <- as.factor(Q3_4merged$PH_or_S8)
for(i in 1:length(Q3_4merged$Freq)) Q3_4merged$Freq[i] <- round(Q3_4merged$Freq[i], 0)
summary(Q3_4merged)

ggplot(Q3_4merged, aes(Q3_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Health issues a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=41)", "S8 (N=159)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_5
all$Q3_5 <- ordered(all$Q3_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_5merged <- rbind(x, y)
Q3_5merged$PH_or_S8 <- as.factor(Q3_5merged$PH_or_S8)
for(i in 1:length(Q3_5merged$Freq)) Q3_5merged$Freq[i] <- round(Q3_5merged$Freq[i], 0)
summary(Q3_5erged)

ggplot(Q3_5merged, aes(Q3_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="High child care expenses a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=38)", "S8 (N=149)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_6
all$Q3_6 <- ordered(all$Q3_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_6merged <- rbind(x, y)
Q3_6merged$PH_or_S8 <- as.factor(Q3_6merged$PH_or_S8)
for(i in 1:length(Q3_6merged$Freq)) Q3_6merged$Freq[i] <- round(Q3_6merged$Freq[i], 0)
summary(Q3_6merged)

ggplot(Q3_6merged, aes(Q3_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Being a single parent/head\nof household a barrier to housing?") + geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=42)", "S8 (N=209)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_7
all$Q3_7 <- ordered(all$Q3_7,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_7merged <- rbind(x, y)
Q3_7merged$PH_or_S8 <- as.factor(Q3_7merged$PH_or_S8)
for(i in 1:length(Q3_7merged$Freq)) Q3_7merged$Freq[i] <- round(Q3_7merged$Freq[i], 0)
summary(Q3_7merged)

ggplot(Q3_7merged, aes(Q3_7, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Bad credit history a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=35)", "S8 (N=181)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_8
all$Q3_8 <- ordered(all$Q3_8,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_8merged <- rbind(x, y)
Q3_8merged$PH_or_S8 <- as.factor(Q3_8merged$PH_or_S8)
for(i in 1:length(Q3_8merged$Freq)) Q3_8merged$Freq[i] <- round(Q3_8merged$Freq[i], 0)
summary(Q3_8merged)

ggplot(Q3_8merged, aes(Q3_8, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not having the knowledge/skills a barrier to housing?") + geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=40)", "S8 (N=171)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q3_9
all$Q3_9 <- ordered(all$Q3_9,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q3_9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q3_9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q3_9merged <- rbind(x, y)
Q3_9merged$PH_or_S8 <- as.factor(Q3_9merged$PH_or_S8)
for(i in 1:length(Q3_9merged$Freq)) Q3_9merged$Freq[i] <- round(Q3_9merged$Freq[i], 0)
summary(Q3_9merged)

ggplot(Q3_9merged, aes(Q3_9, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="High cost of housing a barrier to housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=64)", "S8 (N=197)"))

summary(subset(all, PH_or_S8=="PH"))
#######################################################################

##################### Plotting frequency percentages. Q4

summary(all$Q4)
all$Q4 <- ordered(all$Q4,
                levels = c("No, never", "Yes, 1 time", "Yes, 2 times", "Yes, 3 times", "Yes, 4 or more times"),
                labels = c("No, never", "Yes, 1 time", "Yes, 2 times", "Yes, 3 times", "Yes, 4 or more times"))

x <- as.data.frame(prop.table(xtabs(~Q4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q4merged <- rbind(x, y)
Q4merged$PH_or_S8 <- as.factor(Q4merged$PH_or_S8)
for(i in 1:length(Q4merged$Freq)) Q4merged$Freq[i] <- round(Q4merged$Freq[i], 2)
summary(Q4merged)

ggplot(Q4merged, aes(as.factor(Q4), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Have you paid your rent late\nin the past 6 months?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=84)", "S8 (N=250)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################


##################### Plotting frequency percentages. Q5

summary(all$Q5)
all$Q5 <- ordered(all$Q5,
                levels = c("Employed in a seasonal job (including self-employment)", "Employed year-round full-time  (including self-employment)", "Employed year-round part time (including self-employment)", "Unemployed and not seeking work", "Unemployed, and seeking work"),
                labels = c("Employed in seasonal job", "Employed year-round full-time", "Employed year-round part time", "Unemployed and not seeking work", "Unemployed, and seeking work"))

x <- as.data.frame(prop.table(xtabs(~Q5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q5merged <- rbind(x, y)
Q5merged$PH_or_S8 <- as.factor(Q5merged$PH_or_S8)
for(i in 1:length(Q5merged$Freq)) Q5merged$Freq[i] <- round(Q5merged$Freq[i], 2)
summary(Q5merged)

ggplot(Q5merged, aes(as.factor(Q5), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="What is your current employment status?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=80)", "S8 (N=249)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q6

summary(all$Q6)
all$Q6 <- ordered(all$Q6,
                levels = c("Definitely not", "Probably not", "Not sure", "Probably yes", "Definitely yes"),
                labels = c("Definitely not", "Probably not", "Not sure", "Probably yes", "Definitely yes"))


x <- as.data.frame(prop.table(xtabs(~Q6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q6merged <- rbind(x, y)
Q6merged$PH_or_S8 <- as.factor(Q6merged$PH_or_S8)
for(i in 1:length(Q6merged$Freq)) Q6merged$Freq[i] <- round(Q6merged$Freq[i], 2)
summary(Q6merged)

ggplot(Q6merged, aes(as.factor(Q6), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Do you want or need to work more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=82)", "S8 (N=248)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################


##################### Plotting frequency percentages. Q7

summary(all$Q7)
all$Q7 <- ordered(all$Q7,
                levels = c("My skills do not qualify me for a better paying job at all.", "My skills somehow does not qualify me for a better paying job.", "Neutral", "My skills somehow qualify me for a better paying job at all.", "My skills definitely qualify me for a better paying job."),
                labels = c("Definitely not", "Probably not", "Not sure", "Probably yes", "Definitely yes"))


x <- as.data.frame(prop.table(xtabs(~Q7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q7merged <- rbind(x, y)
Q7merged$PH_or_S8 <- as.factor(Q7merged$PH_or_S8)
for(i in 1:length(Q7merged$Freq)) Q7merged$Freq[i] <- round(Q7merged$Freq[i], 2)
summary(Q7merged)

ggplot(Q7merged, aes(as.factor(Q7), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Do your skills qualify you for a better paying job?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=83)", "S8 (N=244)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q8_1_1
all$Q8_1_1 <- ordered(all$Q8_1_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_1merged <- rbind(x, y)
Q8_1_1merged$PH_or_S8 <- as.factor(Q8_1_1merged$PH_or_S8)
for(i in 1:length(Q8_1_1merged$Freq)) Q8_1_1merged$Freq[i] <- round(Q8_1_1merged$Freq[i], 2)

ggplot(Q8_1_1merged, aes(Q8_1_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Being a student - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=32)", "S8 (N=149)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_2
all$Q8_1_2 <- ordered(all$Q8_1_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_2merged <- rbind(x, y)
Q8_1_2merged$PH_or_S8 <- as.factor(Q8_1_2merged$PH_or_S8)
for(i in 1:length(Q8_1_2merged$Freq)) Q8_1_2merged$Freq[i] <- round(Q8_1_2merged$Freq[i], 2)

ggplot(Q8_1_2merged, aes(Q8_1_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Health problems - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=35)", "S8 (N=149)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_3
all$Q8_1_3 <- ordered(all$Q8_1_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_3merged <- rbind(x, y)
Q8_1_3merged$PH_or_S8 <- as.factor(Q8_1_3merged$PH_or_S8)
for(i in 1:length(Q8_1_3merged$Freq)) Q8_1_3merged$Freq[i] <- round(Q8_1_3merged$Freq[i], 2)

ggplot(Q8_1_3merged, aes(Q8_1_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of education or skills - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=162)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_4
all$Q8_1_4 <- ordered(all$Q8_1_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_4merged <- rbind(x, y)
Q8_1_4merged$PH_or_S8 <- as.factor(Q8_1_4merged$PH_or_S8)
for(i in 1:length(Q8_1_4merged$Freq)) Q8_1_4merged$Freq[i] <- round(Q8_1_4merged$Freq[i], 2)

ggplot(Q8_1_4merged, aes(Q8_1_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of work history - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=42)", "S8 (N=150)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_5
all$Q8_1_5 <- ordered(all$Q8_1_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_5merged <- rbind(x, y)
Q8_1_5merged$PH_or_S8 <- as.factor(Q8_1_5merged$PH_or_S8)
for(i in 1:length(Q8_1_5merged$Freq)) Q8_1_5merged$Freq[i] <- round(Q8_1_5merged$Freq[i], 2)

ggplot(Q8_1_5merged, aes(Q8_1_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=37)", "S8 (N=148)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_6
all$Q8_1_6 <- ordered(all$Q8_1_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_6merged <- rbind(x, y)
Q8_1_6merged$PH_or_S8 <- as.factor(Q8_1_6merged$PH_or_S8)
for(i in 1:length(Q8_1_6merged$Freq)) Q8_1_6merged$Freq[i] <- round(Q8_1_6merged$Freq[i], 2)

ggplot(Q8_1_6merged, aes(Q8_1_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="English proficiency - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=57)", "S8 (N=156)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_7
all$Q8_1_7 <- ordered(all$Q8_1_7,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_7merged <- rbind(x, y)
Q8_1_7merged$PH_or_S8 <- as.factor(Q8_1_7merged$PH_or_S8)
for(i in 1:length(Q8_1_7merged$Freq)) Q8_1_7merged$Freq[i] <- round(Q8_1_7merged$Freq[i], 2)

ggplot(Q8_1_7merged, aes(Q8_1_7, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Discrimination - barrier\nfor you to becoming employed?") + geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=44)", "S8 (N=144)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_8
all$Q8_1_8 <- ordered(all$Q8_1_8,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_8merged <- rbind(x, y)
Q8_1_8merged$PH_or_S8 <- as.factor(Q8_1_8merged$PH_or_S8)
for(i in 1:length(Q8_1_8merged$Freq)) Q8_1_8merged$Freq[i] <- round(Q8_1_8merged$Freq[i], 2)

ggplot(Q8_1_8merged, aes(Q8_1_8, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Having child care responsibilities - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=42)", "S8 (N=164)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_9
all$Q8_1_9 <- ordered(all$Q8_1_9,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_9merged <- rbind(x, y)
Q8_1_9merged$PH_or_S8 <- as.factor(Q8_1_9merged$PH_or_S8)
for(i in 1:length(Q8_1_9merged$Freq)) Q8_1_9merged$Freq[i] <- round(Q8_1_9merged$Freq[i], 2)

ggplot(Q8_1_9merged, aes(Q8_1_9, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Experiencing domestic violence - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=39)", "S8 (N=147)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_10
all$Q8_1_10 <- ordered(all$Q8_1_10,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_10, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_10, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_10merged <- rbind(x, y)
Q8_1_10merged$PH_or_S8 <- as.factor(Q8_1_10merged$PH_or_S8)
for(i in 1:length(Q8_1_10merged$Freq)) Q8_1_10merged$Freq[i] <- round(Q8_1_10merged$Freq[i], 2)

ggplot(Q8_1_10merged, aes(Q8_1_10, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Having a criminal record - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=39)", "S8 (N=143)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_11
all$Q8_1_11 <- ordered(all$Q8_1_11,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_11, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_11, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_11merged <- rbind(x, y)
Q8_1_11merged$PH_or_S8 <- as.factor(Q8_1_11merged$PH_or_S8)
for(i in 1:length(Q8_1_11merged$Freq)) Q8_1_11merged$Freq[i] <- round(Q8_1_11merged$Freq[i], 2)

ggplot(Q8_1_11merged, aes(Q8_1_11, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not enough time to find a job - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=37)", "S8 (N=147)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_12
all$Q8_1_12 <- ordered(all$Q8_1_12,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_12, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_12, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_12merged <- rbind(x, y)
Q8_1_12merged$PH_or_S8 <- as.factor(Q8_1_12merged$PH_or_S8)
for(i in 1:length(Q8_1_12merged$Freq)) Q8_1_12merged$Freq[i] <- round(Q8_1_12merged$Freq[i], 2)

ggplot(Q8_1_12merged, aes(Q8_1_12, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not knowing how to find a job - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=41)", "S8 (N=148)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_13
all$Q8_1_13 <- ordered(all$Q8_1_13,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_13, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_13, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_13merged <- rbind(x, y)
Q8_1_13merged$PH_or_S8 <- as.factor(Q8_1_13merged$PH_or_S8)
for(i in 1:length(Q8_1_13merged$Freq)) Q8_1_13merged$Freq[i] <- round(Q8_1_13merged$Freq[i], 2)

ggplot(Q8_1_13merged, aes(Q8_1_13, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Tight job market, bad economy - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=39)", "S8 (N=152)"))
#######################################################################

##################### Plotting frequency percentages. Q8_1_14
all$Q8_1_14 <- ordered(all$Q8_1_14,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_1_14, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_1_14, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_1_14merged <- rbind(x, y)
Q8_1_14merged$PH_or_S8 <- as.factor(Q8_1_14merged$PH_or_S8)
for(i in 1:length(Q8_1_14merged$Freq)) Q8_1_14merged$Freq[i] <- round(Q8_1_14merged$Freq[i], 2)

ggplot(Q8_1_14merged, aes(Q8_1_14, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Immigration status - barrier\nfor you to becoming employed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=56)", "S8 (N=151)"))

#######################################################################

##################### Plotting frequency percentages. Q8_2_1
all$Q8_2_1 <- ordered(all$Q8_2_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_1merged <- rbind(x, y)
Q8_2_1merged$PH_or_S8 <- as.factor(Q8_2_1merged$PH_or_S8)
for(i in 1:length(Q8_2_1merged$Freq)) Q8_2_1merged$Freq[i] <- round(Q8_2_1merged$Freq[i], 2)

ggplot(Q8_2_1merged, aes(Q8_2_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Being a student - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=27)", "S8 (N=162)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_2
all$Q8_2_2 <- ordered(all$Q8_2_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_2merged <- rbind(x, y)
Q8_2_2merged$PH_or_S8 <- as.factor(Q8_2_2merged$PH_or_S8)
for(i in 1:length(Q8_2_2merged$Freq)) Q8_2_2merged$Freq[i] <- round(Q8_2_2merged$Freq[i], 2)

ggplot(Q8_2_2merged, aes(Q8_2_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Health problems - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=29)", "S8 (N=154)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_3
all$Q8_2_3 <- ordered(all$Q8_2_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_3merged <- rbind(x, y)
Q8_2_3merged$PH_or_S8 <- as.factor(Q8_2_3merged$PH_or_S8)
for(i in 1:length(Q8_2_3merged$Freq)) Q8_2_3merged$Freq[i] <- round(Q8_2_3merged$Freq[i], 2)

ggplot(Q8_2_3merged, aes(Q8_2_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of education or skills - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=35)", "S8 (N=159)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_4
all$Q8_2_4 <- ordered(all$Q8_2_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_4merged <- rbind(x, y)
Q8_2_4merged$PH_or_S8 <- as.factor(Q8_2_4merged$PH_or_S8)
for(i in 1:length(Q8_2_4merged$Freq)) Q8_2_4merged$Freq[i] <- round(Q8_2_4merged$Freq[i], 2)

ggplot(Q8_2_4merged, aes(Q8_2_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of work history - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=32)", "S8 (N=146)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_5
all$Q8_2_5 <- ordered(all$Q8_2_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_5merged <- rbind(x, y)
Q8_2_5merged$PH_or_S8 <- as.factor(Q8_2_5merged$PH_or_S8)
for(i in 1:length(Q8_2_5merged$Freq)) Q8_2_5merged$Freq[i] <- round(Q8_2_5merged$Freq[i], 2)

ggplot(Q8_2_5merged, aes(Q8_2_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=33)", "S8 (N=152)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_6
all$Q8_2_6 <- ordered(all$Q8_2_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_6merged <- rbind(x, y)
Q8_2_6merged$PH_or_S8 <- as.factor(Q8_2_6merged$PH_or_S8)
for(i in 1:length(Q8_2_6merged$Freq)) Q8_2_6merged$Freq[i] <- round(Q8_2_6merged$Freq[i], 2)

ggplot(Q8_2_6merged, aes(Q8_2_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="English proficiency - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=36)", "S8 (N=148)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_7
all$Q8_2_7 <- ordered(all$Q8_2_7,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_7merged <- rbind(x, y)
Q8_2_7merged$PH_or_S8 <- as.factor(Q8_2_7merged$PH_or_S8)
for(i in 1:length(Q8_2_7merged$Freq)) Q8_2_7merged$Freq[i] <- round(Q8_2_7merged$Freq[i], 2)

ggplot(Q8_2_7merged, aes(Q8_2_7, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Discrimination - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=34)", "S8 (N=145)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_8
all$Q8_2_8 <- ordered(all$Q8_2_8,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_8merged <- rbind(x, y)
Q8_2_8merged$PH_or_S8 <- as.factor(Q8_2_8merged$PH_or_S8)
for(i in 1:length(Q8_2_8merged$Freq)) Q8_2_8merged$Freq[i] <- round(Q8_2_8merged$Freq[i], 2)

ggplot(Q8_2_8merged, aes(Q8_2_8, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Having child care responsibilities - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=34)", "S8 (N=172)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_9
all$Q8_2_9 <- ordered(all$Q8_2_9,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_9merged <- rbind(x, y)
Q8_2_9merged$PH_or_S8 <- as.factor(Q8_2_9merged$PH_or_S8)
for(i in 1:length(Q8_2_9merged$Freq)) Q8_2_9merged$Freq[i] <- round(Q8_2_9merged$Freq[i], 2)

ggplot(Q8_2_9merged, aes(Q8_2_9, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Experiencing domestic violence - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=33)", "S8 (N=148)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_10
all$Q8_2_10 <- ordered(all$Q8_2_10,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_10, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_10, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_10merged <- rbind(x, y)
Q8_2_10merged$PH_or_S8 <- as.factor(Q8_2_10merged$PH_or_S8)
for(i in 1:length(Q8_2_10merged$Freq)) Q8_2_10merged$Freq[i] <- round(Q8_2_10merged$Freq[i], 2)

ggplot(Q8_2_10merged, aes(Q8_2_10, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Having a criminal record - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=32)", "S8 (N=146)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_11
all$Q8_2_11 <- ordered(all$Q8_2_11,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_11, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_11, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_11merged <- rbind(x, y)
Q8_2_11merged$PH_or_S8 <- as.factor(Q8_2_11merged$PH_or_S8)
for(i in 1:length(Q8_2_11merged$Freq)) Q8_2_11merged$Freq[i] <- round(Q8_2_11merged$Freq[i], 2)

ggplot(Q8_2_11merged, aes(Q8_2_11, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not enough time - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=30)", "S8 (N=157)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_12
all$Q8_2_12 <- ordered(all$Q8_2_12,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_12, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_12, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_12merged <- rbind(x, y)
Q8_2_12merged$PH_or_S8 <- as.factor(Q8_1_12merged$PH_or_S8)
for(i in 1:length(Q8_2_12merged$Freq)) Q8_2_12merged$Freq[i] <- round(Q8_2_12merged$Freq[i], 2)

ggplot(Q8_2_12merged, aes(Q8_2_12, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not knowing how to find a job - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=34)", "S8 (N=151)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_13
all$Q8_2_13 <- ordered(all$Q8_2_13,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_13, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_13, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_13merged <- rbind(x, y)
Q8_2_13merged$PH_or_S8 <- as.factor(Q8_2_13merged$PH_or_S8)
for(i in 1:length(Q8_2_13merged$Freq)) Q8_2_13merged$Freq[i] <- round(Q8_2_13merged$Freq[i], 2)

ggplot(Q8_2_13merged, aes(Q8_2_13, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Tight job market, bad economy - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=28)", "S8 (N=160)"))
#######################################################################

##################### Plotting frequency percentages. Q8_2_14
all$Q8_2_14 <- ordered(all$Q8_2_14,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q8_2_14, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q8_2_14, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q8_2_14merged <- rbind(x, y)
Q8_2_14merged$PH_or_S8 <- as.factor(Q8_2_14merged$PH_or_S8)
for(i in 1:length(Q8_2_14merged$Freq)) Q8_2_14merged$Freq[i] <- round(Q8_2_14merged$Freq[i], 2)

ggplot(Q8_2_14merged, aes(Q8_2_14, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Immigration status - barrier\nfor you to working more hours?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=39)", "S8 (N=155)")) 

#######################################################################

##################### Plotting frequency percentages. Q9

summary(all$Q9)
all$Q9 <- ordered(all$Q9,
                levels = c("No, never", "Yes, 1 time", "Yes, 2 times", "Yes, 3 times", "Yes, 4 or more times"),
                labels = c("No, never", "Yes, 1 time", "Yes, 2 times", "Yes, 3 times", "Yes, 4 or more times"))


x <- as.data.frame(prop.table(xtabs(~Q9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q9merged <- rbind(x, y)
Q9merged$PH_or_S8 <- as.factor(Q9merged$PH_or_S8)
for(i in 1:length(Q9merged$Freq)) Q9merged$Freq[i] <- round(Q9merged$Freq[i], 2)
summary(Q9merged)

ggplot(Q9merged, aes(as.factor(Q9), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="In the past 3 months, have you run out of money\nfor basic items such as food, medicine, or doctor’s visits?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=85)", "S8 (N=242)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_1

summary(all$Q10_1)
all$Q10_1 <- ordered(all$Q10_1,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_1merged <- rbind(x, y)
Q10_1merged$PH_or_S8 <- as.factor(Q10_1merged$PH_or_S8)
for(i in 1:length(Q10_1merged$Freq)) Q10_1merged$Freq[i] <- round(Q10_1merged$Freq[i], 2)
summary(Q10_1merged)

ggplot(Q10_1merged, aes(as.factor(Q10_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nBuying food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=73)", "S8 (N=237)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_2

summary(all$Q10_2)
all$Q10_2 <- ordered(all$Q10_2,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_2merged <- rbind(x, y)
Q10_2merged$PH_or_S8 <- as.factor(Q10_2merged$PH_or_S8)
for(i in 1:length(Q10_2merged$Freq)) Q10_2merged$Freq[i] <- round(Q10_2merged$Freq[i], 2)
summary(Q10_2merged)

ggplot(Q10_2merged, aes(as.factor(Q10_2), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nReliable housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=64)", "S8 (N=214)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_3

summary(all$Q10_3)
all$Q10_3 <- ordered(all$Q10_3,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_3merged <- rbind(x, y)
Q10_3merged$PH_or_S8 <- as.factor(Q10_3merged$PH_or_S8)
for(i in 1:length(Q10_3merged$Freq)) Q10_3merged$Freq[i] <- round(Q10_3merged$Freq[i], 2)
summary(Q10_3merged)

ggplot(Q10_3merged, aes(as.factor(Q10_3), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nHealth care for
yourself and your family?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=72)", "S8 (N=218)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_4

summary(all$Q10_4)
all$Q10_4 <- ordered(all$Q10_4,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_4merged <- rbind(x, y)
Q10_4merged$PH_or_S8 <- as.factor(Q10_4merged$PH_or_S8)
for(i in 1:length(Q10_4merged$Freq)) Q10_4merged$Freq[i] <- round(Q10_4merged$Freq[i], 2)
summary(Q10_4merged)

ggplot(Q10_4merged, aes(as.factor(Q10_4), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nReliable transportation?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=63)", "S8 (N=231)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_5

summary(all$Q10_5)
all$Q10_5 <- ordered(all$Q10_5,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_5merged <- rbind(x, y)
Q10_5merged$PH_or_S8 <- as.factor(Q10_5merged$PH_or_S8)
for(i in 1:length(Q10_5merged$Freq)) Q10_5merged$Freq[i] <- round(Q10_5merged$Freq[i], 2)
summary(Q10_5merged)

ggplot(Q10_5merged, aes(as.factor(Q10_5), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nReliable child care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=163)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_6
summary(all$Q10_6)
all$Q10_6 <- ordered(all$Q10_6,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_6merged <- rbind(x, y)
Q10_6merged$PH_or_S8 <- as.factor(Q10_6merged$PH_or_S8)
for(i in 1:length(Q10_6merged$Freq)) Q10_6merged$Freq[i] <- round(Q10_6merged$Freq[i], 2)
summary(Q10_6merged)

ggplot(Q10_6merged, aes(as.factor(Q10_6), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nDebt payments?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=57)", "S8 (N=203)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_7
summary(all$Q10_7)
all$Q10_7 <- ordered(all$Q10_7,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_7merged <- rbind(x, y)
Q10_7merged$PH_or_S8 <- as.factor(Q10_7merged$PH_or_S8)
for(i in 1:length(Q10_7merged$Freq)) Q10_7merged$Freq[i] <- round(Q10_7merged$Freq[i], 2)
summary(Q10_7merged)

ggplot(Q10_7merged, aes(as.factor(Q10_7), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nUtilities?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=61)", "S8 (N=243)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q10_8
summary(all$Q10_8)
all$Q10_8 <- ordered(all$Q10_8,
                levels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"),
                labels = c("Very Easy", "Somewhat Easy", "Neutral", "Somewhat Difficult", "Very Difficult"))


x <- as.data.frame(prop.table(xtabs(~Q10_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q10_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q10_8merged <- rbind(x, y)
Q10_8merged$PH_or_S8 <- as.factor(Q10_8merged$PH_or_S8)
for(i in 1:length(Q10_8merged$Freq)) Q10_8merged$Freq[i] <- round(Q10_8merged$Freq[i], 2)
summary(Q10_8merged$Freq)

ggplot(Q10_8merged, aes(as.factor(Q10_8), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How hard is it to pay for-\nSaving money?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=59)", "S8 (N=240)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q11
summary(all$Q11)
all$Q11 <- ordered(all$Q11,
                levels = c("No, never", "Rarely", "Sometimes", "Most of the time", "Yes, all of the time"),
                labels = c("No, never", "Rarely", "Sometimes", "Most of the time", "Yes, all of the time"))


x <- as.data.frame(prop.table(xtabs(~Q11, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q11, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q11merged <- rbind(x, y)
Q11merged$PH_or_S8 <- as.factor(Q11merged$PH_or_S8)
for(i in 1:length(Q11merged$Freq)) Q11merged$Freq[i] <- round(Q11merged$Freq[i], 2)
summary(Q11merged$Freq)

ggplot(Q11merged, aes(as.factor(Q11), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="In the past 3 months, did you or someone\nin your family ever cut the size of a meal or skip meals\nbecause you did not have enough money for food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=59)", "S8 (N=240)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q12
all$Q12 <- ordered(all$Q12,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q12, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q12, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q12merged <- rbind(x, y)
Q12merged$PH_or_S8 <- as.factor(Q12merged$PH_or_S8)
for(i in 1:length(Q12merged$Freq)) Q12merged$Freq[i] <- round(Q12merged$Freq[i], 2)

ggplot(Q12merged, aes(Q12, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you relying on sources other\nthan your income to get food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=68)", "S8 (N=238)"))
#######################################################################

##################### Plotting frequency percentages. Q13_1
all$Q13_1 <- ordered(all$Q13_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q13_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q13_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q13_1merged <- rbind(x, y)
Q13_1merged$PH_or_S8 <- as.factor(Q13_1merged$PH_or_S8)
for(i in 1:length(Q13_1merged$Freq)) Q13_1merged$Freq[i] <- round(Q13_1merged$Freq[i], 2)

ggplot(Q13_1merged, aes(Q13_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Is food assistance (food stamps) a source to get food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=186)"))
#######################################################################

##################### Plotting frequency percentages. Q13_2
all$Q13_2 <- ordered(all$Q13_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q13_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q13_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q13_2merged <- rbind(x, y)
Q13_2merged$PH_or_S8 <- as.factor(Q13_2merged$PH_or_S8)
for(i in 1:length(Q13_2merged$Freq)) Q13_2merged$Freq[i] <- round(Q13_2merged$Freq[i], 2)

ggplot(Q13_2merged, aes(Q13_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are Food banks a source to get food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=35)", "S8 (N=154)"))
#######################################################################

##################### Plotting frequency percentages. Q13_3
all$Q13_3 <- ordered(all$Q13_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q13_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q13_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q13_3merged <- rbind(x, y)
Q13_3merged$PH_or_S8 <- as.factor(Q13_3merged$PH_or_S8)
for(i in 1:length(Q13_3merged$Freq)) Q13_3merged$Freq[i] <- round(Q13_3merged$Freq[i], 2)

ggplot(Q13_3merged, aes(Q13_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are friends a source to get food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=24)", "S8 (N=131)"))
#######################################################################

##################### Plotting frequency percentages. Q13_4
all$Q13_4 <- ordered(all$Q13_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q13_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q13_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q13_4merged <- rbind(x, y)
Q13_4merged$PH_or_S8 <- as.factor(Q13_4merged$PH_or_S8)
for(i in 1:length(Q13_4merged$Freq)) Q13_4merged$Freq[i] <- round(Q13_4merged$Freq[i], 2)

ggplot(Q13_4merged, aes(Q13_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are neighbors a source to get food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=25)", "S8 (N=124)"))
#######################################################################

##################### Plotting frequency percentages. Q13_5
all$Q13_5 <- ordered(all$Q13_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q13_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q13_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q13_5merged <- rbind(x, y)
Q13_5merged$PH_or_S8 <- as.factor(Q13_5merged$PH_or_S8)
for(i in 1:length(Q13_5merged$Freq)) Q13_5merged$Freq[i] <- round(Q13_5merged$Freq[i], 2)

ggplot(Q13_5merged, aes(Q13_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are family members a source to get food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=26)", "S8 (N=130)"))
#######################################################################

##################### Plotting frequency percentages. Q14
all$Q14 <- ordered(all$Q14,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q14, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q14, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q14merged <- rbind(x, y)
Q14merged$PH_or_S8 <- as.factor(Q14merged$PH_or_S8)
for(i in 1:length(Q14merged$Freq)) Q14merged$Freq[i] <- round(Q14merged$Freq[i], 2)

ggplot(Q14merged, aes(Q14, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Do you have problems getting food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=66)", "S8 (N=224)"))
#######################################################################

##################### Plotting frequency percentages. Q15_1
all$Q15_1 <- ordered(all$Q15_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q15_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q15_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q15_1merged <- rbind(x, y)
Q15_1merged$PH_or_S8 <- as.factor(Q15_1merged$PH_or_S8)
for(i in 1:length(Q15_1merged$Freq)) Q15_1merged$Freq[i] <- round(Q15_1merged$Freq[i], 2)

ggplot(Q15_1merged, aes(Q15_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Is lack of income a barrier to\ngetting food without depending on others?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=32)", "S8 (N=108)"))
#######################################################################

##################### Plotting frequency percentages. Q15_2
all$Q15_2 <- ordered(all$Q15_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q15_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q15_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q15_2merged <- rbind(x, y)
Q15_2merged$PH_or_S8 <- as.factor(Q15_2merged$PH_or_S8)
for(i in 1:length(Q15_2merged$Freq)) Q15_2merged$Freq[i] <- round(Q15_2merged$Freq[i], 2)

ggplot(Q15_2merged, aes(Q15_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Is lack of easy access to the stores a barrier to\ngetting food without depending on others?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=21)", "S8 (N=79)"))
#######################################################################

##################### Plotting frequency percentages. Q15_4
all$Q15_4 <- ordered(all$Q15_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q15_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q15_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q15_4merged <- rbind(x, y)
Q15_4merged$PH_or_S8 <- as.factor(Q15_4merged$PH_or_S8)
for(i in 1:length(Q15_4merged$Freq)) Q15_4merged$Freq[i] <- round(Q15_4merged$Freq[i], 2)

ggplot(Q15_4merged, aes(Q15_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Is lack of knowledge to find nutritious food a barrier to\ngetting food without depending on others?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=23)", "S8 (N=80)"))
#######################################################################

##################### Plotting frequency percentages. Q16_1
summary(all$Q16_1)
all$Q16_1 <- ordered(all$Q16_1,
                levels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"),
                labels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"))


x <- as.data.frame(prop.table(xtabs(~Q16_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q16_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q16_1merged <- rbind(x, y)
Q16_1merged$PH_or_S8 <- as.factor(Q16_1merged$PH_or_S8)
for(i in 1:length(Q16_1merged$Freq)) Q16_1merged$Freq[i] <- round(Q16_1merged$Freq[i], 2)
summary(Q16_1merged$Freq)

ggplot(Q16_1merged, aes(as.factor(Q16_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How satisfied are you with the following\nmeans of transportation - My own car?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=66)", "S8 (N=214)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q16_2
summary(all$Q16_2)
all$Q16_2 <- ordered(all$Q16_2,
                levels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"),
                labels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"))


x <- as.data.frame(prop.table(xtabs(~Q16_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q16_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q16_2merged <- rbind(x, y)
Q16_2merged$PH_or_S8 <- as.factor(Q16_2merged$PH_or_S8)
for(i in 1:length(Q16_2merged$Freq)) Q16_2merged$Freq[i] <- round(Q16_2merged$Freq[i], 2)
summary(Q16_2merged$Freq)

ggplot(Q16_2merged, aes(as.factor(Q16_2), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How satisfied are you with the following\nmeans of transportation - Carpool?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=27)", "S8 (N=82)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q16_3
summary(all$Q16_3)
all$Q16_3 <- ordered(all$Q16_3,
                levels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"),
                labels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"))


x <- as.data.frame(prop.table(xtabs(~Q16_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q16_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q16_3merged <- rbind(x, y)
Q16_3merged$PH_or_S8 <- as.factor(Q16_3merged$PH_or_S8)
for(i in 1:length(Q16_3merged$Freq)) Q16_3merged$Freq[i] <- round(Q16_3merged$Freq[i], 2)
summary(Q16_3merged$Freq)

ggplot(Q16_3merged, aes(as.factor(Q16_3), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How satisfied are you with the following\nmeans of transportation - Bus?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=49)", "S8 (N=148)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q16_4
summary(all$Q16_4)
all$Q16_4 <- ordered(all$Q16_4,
                levels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"),
                labels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"))


x <- as.data.frame(prop.table(xtabs(~Q16_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q16_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q16_4merged <- rbind(x, y)
Q16_4merged$PH_or_S8 <- as.factor(Q16_4merged$PH_or_S8)
for(i in 1:length(Q16_4merged$Freq)) Q16_4merged$Freq[i] <- round(Q16_4merged$Freq[i], 2)
summary(Q16_4merged$Freq)

ggplot(Q16_4merged, aes(as.factor(Q16_4), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How satisfied are you with the following\nmeans of transportation - Motorcycle?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=10)", "S8 (N=24)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q16_5
summary(all$Q16_5)
all$Q16_5 <- ordered(all$Q16_5,
                levels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"),
                labels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"))


x <- as.data.frame(prop.table(xtabs(~Q16_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q16_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q16_5merged <- rbind(x, y)
Q16_5merged$PH_or_S8 <- as.factor(Q16_5merged$PH_or_S8)
for(i in 1:length(Q16_5merged$Freq)) Q16_5merged$Freq[i] <- round(Q16_5merged$Freq[i], 2)
summary(Q16_5merged$Freq)

ggplot(Q16_5merged, aes(as.factor(Q16_5), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How satisfied are you with the following\nmeans of transportation - Bicycle?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=35)", "S8 (N=104)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q16_6
summary(all$Q16_6)
all$Q16_6 <- ordered(all$Q16_6,
                levels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"),
                labels = c("Very dissatisfied", "Somewhat dissatisfied", "Neutral", "Somewhat satisfied", "Very satisfied"))


x <- as.data.frame(prop.table(xtabs(~Q16_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q16_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q16_6merged <- rbind(x, y)
Q16_6merged$PH_or_S8 <- as.factor(Q16_6merged$PH_or_S8)
for(i in 1:length(Q16_6merged$Freq)) Q16_6merged$Freq[i] <- round(Q16_6merged$Freq[i], 2)
summary(Q16_6merged$Freq)

ggplot(Q16_6merged, aes(as.factor(Q16_6), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How satisfied are you with the following\nmeans of transportation - Walking?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=57)", "S8 (N=191)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q17

summary(all$Q17)
all$Q17 <- ordered(all$Q17,
                levels = c("No, never", "Yes, 1 time", "Yes, 2 times", "Yes, 3 times", "Yes, 4 times or more"),
                labels = c("No, never", "Yes, 1 time", "Yes, 2 times", "Yes, 3 times", "Yes, 4 times or more"))

x <- as.data.frame(prop.table(xtabs(~Q17, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q17, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q17merged <- rbind(x, y)
Q17merged$PH_or_S8 <- as.factor(Q17merged$PH_or_S8)
for(i in 1:length(Q17merged$Freq)) Q17merged$Freq[i] <- round(Q17merged$Freq[i], 2)
summary(Q17merged)

ggplot(Q17merged, aes(as.factor(Q17), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="During the last two weeks, was it hard for you\nto get to work or
appointments?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=78)", "S8 (N=240)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q18_1
all$Q18_1 <- ordered(all$Q18_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_1merged <- rbind(x, y)
Q18_1merged$PH_or_S8 <- as.factor(Q18_1merged$PH_or_S8)
for(i in 1:length(Q18_1merged$Freq)) Q18_1merged$Freq[i] <- round(Q18_1merged$Freq[i], 2)

ggplot(Q18_1merged, aes(Q18_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nLive far from work, grocery store, etc.?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=23)", "S8 (N=107)"))
#######################################################################

##################### Plotting frequency percentages. Q18_2
all$Q18_2 <- ordered(all$Q18_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_2merged <- rbind(x, y)
Q18_2merged$PH_or_S8 <- as.factor(Q18_2merged$PH_or_S8)
for(i in 1:length(Q18_2merged$Freq)) Q18_2merged$Freq[i] <- round(Q18_2merged$Freq[i], 2)

ggplot(Q18_2merged, aes(Q18_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nPersonal or family members’ health?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=28)", "S8 (N=110)"))
#######################################################################

##################### Plotting frequency percentages. Q18_3
all$Q18_3 <- ordered(all$Q18_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_3merged <- rbind(x, y)
Q18_3merged$PH_or_S8 <- as.factor(Q18_3merged$PH_or_S8)
for(i in 1:length(Q18_3merged$Freq)) Q18_3merged$Freq[i] <- round(Q18_3merged$Freq[i], 2)

ggplot(Q18_3merged, aes(Q18_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nBus stops are too far?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=20)", "S8 (N=106)"))
#######################################################################

##################### Plotting frequency percentages. Q18_4
all$Q18_4 <- ordered(all$Q18_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_4merged <- rbind(x, y)
Q18_4merged$PH_or_S8 <- as.factor(Q18_4merged$PH_or_S8)
for(i in 1:length(Q18_4merged$Freq)) Q18_4merged$Freq[i] <- round(Q18_4merged$Freq[i], 2)

ggplot(Q18_4merged, aes(Q18_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nBus schedule is not convenient?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=22)", "S8 (N=102)"))
#######################################################################

##################### Plotting frequency percentages. Q18_5
all$Q18_5 <- ordered(all$Q18_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_5merged <- rbind(x, y)
Q18_5merged$PH_or_S8 <- as.factor(Q18_5merged$PH_or_S8)
for(i in 1:length(Q18_5merged$Freq)) Q18_5merged$Freq[i] <- round(Q18_5merged$Freq[i], 2)

ggplot(Q18_5merged, aes(Q18_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nBus fares?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=25)", "S8 (N=108)"))
#######################################################################

##################### Plotting frequency percentages. Q18_6
all$Q18_6 <- ordered(all$Q18_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_6merged <- rbind(x, y)
Q18_6merged$PH_or_S8 <- as.factor(Q18_6merged$PH_or_S8)
for(i in 1:length(Q18_6merged$Freq)) Q18_6merged$Freq[i] <- round(Q18_6merged$Freq[i], 2)

ggplot(Q18_6merged, aes(Q18_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nGas costs?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=25)", "S8 (N=117)"))
#######################################################################

##################### Plotting frequency percentages. Q18_7
all$Q18_7 <- ordered(all$Q18_7,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_7merged <- rbind(x, y)
Q18_7merged$PH_or_S8 <- as.factor(Q18_7merged$PH_or_S8)
for(i in 1:length(Q18_7merged$Freq)) Q18_7merged$Freq[i] <- round(Q18_7merged$Freq[i], 2)

ggplot(Q18_7merged, aes(Q18_7, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nDon’t have a bike?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=18)", "S8 (N=104)"))
#######################################################################

##################### Plotting frequency percentages. Q18_8
all$Q18_8 <- ordered(all$Q18_8,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_8merged <- rbind(x, y)
Q18_8merged$PH_or_S8 <- as.factor(Q18_8merged$PH_or_S8)
for(i in 1:length(Q18_8merged$Freq)) Q18_8merged$Freq[i] <- round(Q18_8merged$Freq[i], 2)

ggplot(Q18_8merged, aes(Q18_8, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nDon’t have a car?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=20)", "S8 (N=108)"))
#######################################################################

##################### Plotting frequency percentages. Q18_9
all$Q18_9 <- ordered(all$Q18_9,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_9merged <- rbind(x, y)
Q18_9merged$PH_or_S8 <- as.factor(Q18_9merged$PH_or_S8)
for(i in 1:length(Q18_9merged$Freq)) Q18_9merged$Freq[i] <- round(Q18_9merged$Freq[i], 2)

ggplot(Q18_9merged, aes(Q18_9, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nDon’t have a ride?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=17)", "S8 (N=101)"))
#######################################################################

##################### Plotting frequency percentages. Q18_10
all$Q18_10 <- ordered(all$Q18_10,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q18_10, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q18_10, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q18_10merged <- rbind(x, y)
Q18_10merged$PH_or_S8 <- as.factor(Q18_10merged$PH_or_S8)
for(i in 1:length(Q18_10merged$Freq)) Q18_10merged$Freq[i] <- round(Q18_10merged$Freq[i], 2)

ggplot(Q18_10merged, aes(Q18_10, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Transportation barriers -\nDon’t know how to get to places/not familiar\nwith the area/don’t have directions?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=17)", "S8 (N=98)"))
#######################################################################

##################### Plotting frequency percentages. Q19
all$Q19 <- ordered(all$Q19,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q19, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q19, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q19merged <- rbind(x, y)
Q19merged$PH_or_S8 <- as.factor(Q19merged$PH_or_S8)
for(i in 1:length(Q19merged$Freq)) Q19merged$Freq[i] <- round(Q19merged$Freq[i], 2)

ggplot(Q19merged, aes(Q19, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Do you have any children under the age of 13?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=83)", "S8 (N=247)"))
#######################################################################

##################### Plotting frequency percentages. Q20
summary(all$Q20)
all$Q20 <- ordered(all$Q20,
                levels = c("Yes, I currently have sufficient child care", "No, I currently have no child care, but need it", "No, I currently have some child care, but need more", "N/A, I currently do not need child care"),
                labels = c("Yes, I currently have sufficient child care", "No, I currently have no child care, but need it", "No, I currently have some child care, but need more", "N/A, I currently do not need child care"))


x <- as.data.frame(prop.table(xtabs(~Q20, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q20, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q20merged <- rbind(x, y)
Q20merged$PH_or_S8 <- as.factor(Q20merged$PH_or_S8)
for(i in 1:length(Q20merged$Freq)) Q20merged$Freq[i] <- round(Q20merged$Freq[i], 2)
summary(Q20merged$Freq)

ggplot(Q20merged, aes(as.factor(Q20), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Do you currently have sufficient child care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 60, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=57)", "S8 (N=185)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q21_1
summary(all$Q21_1)
all$Q21_1 <- ordered(all$Q21_1,
                levels = c("Very good", "Good", "Neutral", "Poor", "Very poor"),
                labels = c("Very good", "Good", "Neutral", "Poor", "Very poor"))


x <- as.data.frame(prop.table(xtabs(~Q21_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q21_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q21_1merged <- rbind(x, y)
Q21_1merged$PH_or_S8 <- as.factor(Q21_1merged$PH_or_S8)
for(i in 1:length(Q21_1merged$Freq)) Q21_1merged$Freq[i] <- round(Q21_1merged$Freq[i], 2)
summary(Q21_1merged$Freq)

ggplot(Q21_1merged, aes(as.factor(Q21_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How do you evaluate the accessibility\nof child care in your neighborhood?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=21)", "S8 (N=112)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q21_2
summary(all$Q21_2)
all$Q21_2 <- ordered(all$Q21_2,
                levels = c("Very good", "Good", "Neutral", "Poor", "Very poor"),
                labels = c("Very good", "Good", "Neutral", "Poor", "Very poor"))


x <- as.data.frame(prop.table(xtabs(~Q21_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q21_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q21_2merged <- rbind(x, y)
Q21_2merged$PH_or_S8 <- as.factor(Q21_2merged$PH_or_S8)
for(i in 1:length(Q21_2merged$Freq)) Q21_2merged$Freq[i] <- round(Q21_2merged$Freq[i], 2)
summary(Q21_2merged$Freq)

ggplot(Q21_2merged, aes(as.factor(Q21_2), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How do you evaluate the quality\nof child care in your neighborhood?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=16)", "S8 (N=109)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q21_3
summary(all$Q21_3)
all$Q21_3 <- ordered(all$Q21_3,
                levels = c("Very good", "Good", "Neutral", "Poor", "Very poor"),
                labels = c("Very good", "Good", "Neutral", "Poor", "Very poor"))


x <- as.data.frame(prop.table(xtabs(~Q21_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q21_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q21_3merged <- rbind(x, y)
Q21_3merged$PH_or_S8 <- as.factor(Q21_3merged$PH_or_S8)
for(i in 1:length(Q21_3merged$Freq)) Q21_3merged$Freq[i] <- round(Q21_3merged$Freq[i], 2)
summary(Q21_3merged$Freq)

ggplot(Q21_3merged, aes(as.factor(Q21_3), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How do you evaluate the affordability\nof child care in your neighborhood?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=15)", "S8 (N=113)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q22_1
summary(all$Q22_1)
all$Q22_1 <- ordered(all$Q22_1,
                levels = c("Definitely yes", "Probably yes", "Maybe", "Probably not", "Definitely not"),
                labels = c("Definitely yes", "Probably yes", "Maybe", "Probably not", "Definitely not"))


x <- as.data.frame(prop.table(xtabs(~Q22_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q22_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q22_1merged <- rbind(x, y)
Q22_1merged$PH_or_S8 <- as.factor(Q22_1merged$PH_or_S8)
for(i in 1:length(Q22_1merged$Freq)) Q22_1merged$Freq[i] <- round(Q22_1merged$Freq[i], 2)
summary(Q22_1merged$Freq)

ggplot(Q22_1merged, aes(as.factor(Q22_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Is accessibility of child care\npreventing you from getting child care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=19)", "S8 (N=114)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q22_2
summary(all$Q22_2)
all$Q22_2 <- ordered(all$Q22_2,
                levels = c("Definitely yes", "Probably yes", "Maybe", "Probably not", "Definitely not"),
                labels = c("Definitely yes", "Probably yes", "Maybe", "Probably not", "Definitely not"))


x <- as.data.frame(prop.table(xtabs(~Q22_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q22_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q22_2merged <- rbind(x, y)
Q22_2merged$PH_or_S8 <- as.factor(Q22_2merged$PH_or_S8)
for(i in 1:length(Q22_2merged$Freq)) Q22_2merged$Freq[i] <- round(Q22_2merged$Freq[i], 2)
summary(Q22_2merged$Freq)

ggplot(Q22_2merged, aes(as.factor(Q22_2), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Is quality of child care\npreventing you from getting child care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=17)", "S8 (N=115)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q22_3
summary(all$Q22_3)
all$Q22_3 <- ordered(all$Q22_3,
                levels = c("Definitely yes", "Probably yes", "Maybe", "Probably not", "Definitely not"),
                labels = c("Definitely yes", "Probably yes", "Maybe", "Probably not", "Definitely not"))


x <- as.data.frame(prop.table(xtabs(~Q22_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q22_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q22_3merged <- rbind(x, y)
Q22_3merged$PH_or_S8 <- as.factor(Q22_3merged$PH_or_S8)
for(i in 1:length(Q22_3merged$Freq)) Q22_3merged$Freq[i] <- round(Q22_3merged$Freq[i], 2)
summary(Q22_3merged$Freq)

ggplot(Q22_3merged, aes(as.factor(Q22_3), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Is affordability of child care\npreventing you from getting child care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=18)", "S8 (N=122)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q23_1
summary(all$Q23_1)
all$Q23_1 <- ordered(all$Q23_1,
                levels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"),
                labels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"))


x <- as.data.frame(prop.table(xtabs(~Q23_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q23_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q23_1merged <- rbind(x, y)
Q23_1merged$PH_or_S8 <- as.factor(Q23_1merged$PH_or_S8)
for(i in 1:length(Q23_1merged$Freq)) Q23_1merged$Freq[i] <- round(Q23_1merged$Freq[i], 2)
summary(Q23_1merged$Freq)

ggplot(Q23_1merged, aes(as.factor(Q23_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="During the last 3 months, how many times did you get help\n(for example, food, child care, money) from a church?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=66)", "S8 (N=222)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q23_2
summary(all$Q23_2)
all$Q23_2 <- ordered(all$Q23_2,
                levels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"),
                labels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"))


x <- as.data.frame(prop.table(xtabs(~Q23_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q23_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q23_2merged <- rbind(x, y)
Q23_2merged$PH_or_S8 <- as.factor(Q23_2merged$PH_or_S8)
for(i in 1:length(Q23_2merged$Freq)) Q23_2merged$Freq[i] <- round(Q23_2merged$Freq[i], 2)
summary(Q23_2merged$Freq)

ggplot(Q23_2merged, aes(as.factor(Q23_2), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="During the last 3 months, how many times did you get help\n(for example, food, child care, money) from a charitable organization?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=66)", "S8 (N=224)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q23_3
summary(all$Q23_3)
all$Q23_3 <- ordered(all$Q23_3,
                levels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"),
                labels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"))


x <- as.data.frame(prop.table(xtabs(~Q23_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q23_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q23_3merged <- rbind(x, y)
Q23_3merged$PH_or_S8 <- as.factor(Q23_3merged$PH_or_S8)
for(i in 1:length(Q23_3merged$Freq)) Q23_3merged$Freq[i] <- round(Q23_3merged$Freq[i], 2)
summary(Q23_3merged$Freq)

ggplot(Q23_3merged, aes(as.factor(Q23_3), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="During the last 3 months, how many times did you get help\n(for example, food, child care, money) from a local support group?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=62)", "S8 (N=223)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q23_4
summary(all$Q23_4)
all$Q23_4 <- ordered(all$Q23_4,
                levels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"),
                labels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"))


x <- as.data.frame(prop.table(xtabs(~Q23_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q23_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q23_4merged <- rbind(x, y)
Q23_4merged$PH_or_S8 <- as.factor(Q23_4merged$PH_or_S8)
for(i in 1:length(Q23_4merged$Freq)) Q23_4merged$Freq[i] <- round(Q23_4merged$Freq[i], 2)
summary(Q23_4merged$Freq)

ggplot(Q23_4merged, aes(as.factor(Q23_4), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="During the last 3 months, how many times did you get help\n(for example, food, child care, money) from family?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=65)", "S8 (N=229)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q23_5
summary(all$Q23_5)
all$Q23_5 <- ordered(all$Q23_5,
                levels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"),
                labels = c("Never", "1-2 times", "3-4 times", "5-6 times", "7 times or more"))


x <- as.data.frame(prop.table(xtabs(~Q23_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q23_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q23_5merged <- rbind(x, y)
Q23_5merged$PH_or_S8 <- as.factor(Q23_5merged$PH_or_S8)
for(i in 1:length(Q23_5merged$Freq)) Q23_5merged$Freq[i] <- round(Q23_5merged$Freq[i], 2)
summary(Q23_5merged$Freq)

ggplot(Q23_5merged, aes(as.factor(Q23_5), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="During the last 3 months, how many times did you get help\n(for example, food, child care, money) from friends/neighbors?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=67)", "S8 (N=223)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q24_1
all$Q24_1 <- ordered(all$Q24_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q24_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q24_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q24_1merged <- rbind(x, y)
Q24_1merged$PH_or_S8 <- as.factor(Q24_1merged$PH_or_S8)
for(i in 1:length(Q24_1merged$Freq)) Q24_1merged$Freq[i] <- round(Q24_1merged$Freq[i], 2)

ggplot(Q24_1merged, aes(Q24_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Living far from family and friends - a barrier\nin establishing or expanding your connections\nwith people and organizations you can count on for help?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=61)", "S8 (N=231)"))
#######################################################################

##################### Plotting frequency percentages. Q24_2
all$Q24_2 <- ordered(all$Q24_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q24_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q24_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q24_2merged <- rbind(x, y)
Q24_2merged$PH_or_S8 <- as.factor(Q24_2merged$PH_or_S8)
for(i in 1:length(Q24_2merged$Freq)) Q24_2merged$Freq[i] <- round(Q24_2merged$Freq[i], 2)

ggplot(Q24_2merged, aes(Q24_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Living far from community organizations - a barrier\nin establishing or expanding your connections\nwith people and organizations you can count on for help?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=220)"))
#######################################################################

##################### Plotting frequency percentages. Q24_3
all$Q24_3 <- ordered(all$Q24_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q24_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q24_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q24_3merged <- rbind(x, y)
Q24_3merged$PH_or_S8 <- as.factor(Q24_3merged$PH_or_S8)
for(i in 1:length(Q24_3merged$Freq)) Q24_3merged$Freq[i] <- round(Q24_3merged$Freq[i], 2)

ggplot(Q24_3merged, aes(Q24_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Living far from people who share my interests - a barrier\nin establishing or expanding your connections\nwith people and organizations you can count on for help?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=49)", "S8 (N=221)"))
#######################################################################

##################### Plotting frequency percentages. Q24_4
all$Q24_4 <- ordered(all$Q24_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q24_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q24_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q24_4merged <- rbind(x, y)
Q24_4merged$PH_or_S8 <- as.factor(Q24_4merged$PH_or_S8)
for(i in 1:length(Q24_4merged$Freq)) Q24_4merged$Freq[i] <- round(Q24_4merged$Freq[i], 2)

ggplot(Q24_4merged, aes(Q24_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Cannot afford social events - a barrier\nin establishing or expanding your connections\nwith people and organizations you can count on for help?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=54)", "S8 (N=226)"))
#######################################################################

##################### Plotting frequency percentages. Q24_5
all$Q24_5 <- ordered(all$Q24_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q24_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q24_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q24_5merged <- rbind(x, y)
Q24_5merged$PH_or_S8 <- as.factor(Q24_5merged$PH_or_S8)
for(i in 1:length(Q24_5merged$Freq)) Q24_5merged$Freq[i] <- round(Q24_5merged$Freq[i], 2)

ggplot(Q24_5merged, aes(Q24_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Not having enough time for social events - a barrier\nin establishing or expanding your connections\nwith people and organizations you can count on for help?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=57)", "S8 (N=229)"))
#######################################################################

##################### Plotting frequency percentages. Q24_6
all$Q24_6 <- ordered(all$Q24_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q24_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q24_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q24_6merged <- rbind(x, y)
Q24_6merged$PH_or_S8 <- as.factor(Q24_6merged$PH_or_S8)
for(i in 1:length(Q24_6merged$Freq)) Q24_6merged$Freq[i] <- round(Q24_6merged$Freq[i], 2)

ggplot(Q24_6merged, aes(Q24_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Don’t know how to find community organizations/social events -\na barrier in establishing or expanding your connections\nwith people and organizations you can count on for help?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=50)", "S8 (N=224)"))
#######################################################################

##################### Plotting frequency percentages. Q25_1
all$Q25_1 <- ordered(all$Q25_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_1merged <- rbind(x, y)
Q25_1merged$PH_or_S8 <- as.factor(Q25_1merged$PH_or_S8)
for(i in 1:length(Q25_1merged$Freq)) Q25_1merged$Freq[i] <- round(Q25_1merged$Freq[i], 2)

ggplot(Q25_1merged, aes(Q25_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - SNAP (Food Stamps)?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=77)", "S8 (N=245)"))
#######################################################################

##################### Plotting frequency percentages. Q25_2
all$Q25_2 <- ordered(all$Q25_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_2merged <- rbind(x, y)
Q25_2merged$PH_or_S8 <- as.factor(Q25_2merged$PH_or_S8)
for(i in 1:length(Q25_2merged$Freq)) Q25_2merged$Freq[i] <- round(Q25_2merged$Freq[i], 2)

ggplot(Q25_2merged, aes(Q25_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - Medicaid?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=77)", "S8 (N=246)"))
#######################################################################

##################### Plotting frequency percentages. Q25_3
all$Q25_3 <- ordered(all$Q25_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_3merged <- rbind(x, y)
Q25_3merged$PH_or_S8 <- as.factor(Q25_3merged$PH_or_S8)
for(i in 1:length(Q25_3merged$Freq)) Q25_3merged$Freq[i] <- round(Q25_3merged$Freq[i], 2)

ggplot(Q25_3merged, aes(Q25_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - CHP+ (Colorado Health Plan Plus)?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=54)", "S8 (N=206)"))
#######################################################################

##################### Plotting frequency percentages. Q25_4
all$Q25_4 <- ordered(all$Q25_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_4merged <- rbind(x, y)
Q25_4merged$PH_or_S8 <- as.factor(Q25_4merged$PH_or_S8)
for(i in 1:length(Q25_4merged$Freq)) Q25_4merged$Freq[i] <- round(Q25_4merged$Freq[i], 2)

ggplot(Q25_4merged, aes(Q25_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - LEAP (Energy assistance)?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=52)", "S8 (N=224)"))
#######################################################################

##################### Plotting frequency percentages. Q25_5
all$Q25_5 <- ordered(all$Q25_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_5merged <- rbind(x, y)
Q25_5merged$PH_or_S8 <- as.factor(Q25_5merged$PH_or_S8)
for(i in 1:length(Q25_5merged$Freq)) Q25_5merged$Freq[i] <- round(Q25_5merged$Freq[i], 2)

ggplot(Q25_5merged, aes(Q25_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - Free/reduced lunch?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=73)", "S8 (N=233)"))
#######################################################################

##################### Plotting frequency percentages. Q25_6
all$Q25_6 <- ordered(all$Q25_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_6merged <- rbind(x, y)
Q25_6merged$PH_or_S8 <- as.factor(Q25_6merged$PH_or_S8)
for(i in 1:length(Q25_6merged$Freq)) Q25_6merged$Freq[i] <- round(Q25_6merged$Freq[i], 2)

ggplot(Q25_6merged, aes(Q25_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - TANF (Temporary Aid to Needy Families)?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=53)", "S8 (N=211)"))
#######################################################################

##################### Plotting frequency percentages. Q25_7
all$Q25_7 <- ordered(all$Q25_7,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q25_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q25_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q25_7merged <- rbind(x, y)
Q25_7merged$PH_or_S8 <- as.factor(Q25_7merged$PH_or_S8)
for(i in 1:length(Q25_7merged$Freq)) Q25_7merged$Freq[i] <- round(Q25_7merged$Freq[i], 2)

ggplot(Q25_7merged, aes(Q25_7, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you receiving - CCAP (Child Care Assistance Program)?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=54)", "S8 (N=208)"))
#######################################################################

##################### Plotting frequency percentages. Q26
all$Q26 <- ordered(all$Q26,
                levels = c("I do not currently have a legal issue.", "I currently have legal issues and have legal assistance.", "I currently have a legal problem and do not have legal assistance"),
                labels = c("Do not have a legal issue", "Have legal issues and have legal assistance", "Have legal issues but no legal assistance"))

x <- as.data.frame(prop.table(xtabs(~Q26, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q26, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q26merged <- rbind(x, y)
Q26merged$PH_or_S8 <- as.factor(Q26merged$PH_or_S8)
for(i in 1:length(Q26merged$Freq)) Q26merged$Freq[i] <- round(Q26merged$Freq[i], 2)
summary(Q26merged)

ggplot(Q26merged, aes(as.factor(Q26), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Are you or a member of your household\ncurrently dealing with any legal issues?") + 
   geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 60, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=67)", "S8 (N=230)"))

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q27_1
all$Q27_1 <- ordered(all$Q27_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q27_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q27_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q27_1merged <- rbind(x, y)
Q27_1merged$PH_or_S8 <- as.factor(Q27_1merged$PH_or_S8)
for(i in 1:length(Q27_1merged$Freq)) Q27_1merged$Freq[i] <- round(Q27_1merged$Freq[i], 2)

ggplot(Q27_1merged, aes(Q27_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Don’t know how to access appropriate legal assistance -\nbarrier to resolving your legal issues?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=17)", "S8 (N=53)"))
#######################################################################

##################### Plotting frequency percentages. Q27_2
all$Q27_2 <- ordered(all$Q27_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q27_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q27_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q27_2merged <- rbind(x, y)
Q27_2merged$PH_or_S8 <- as.factor(Q27_2merged$PH_or_S8)
for(i in 1:length(Q27_2merged$Freq)) Q27_2merged$Freq[i] <- round(Q27_2merged$Freq[i], 2)

ggplot(Q27_2merged, aes(Q27_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Don’t have money to pay for appropriate legal assistance -\nbarrier to resolving your legal issues?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=13)", "S8 (N=56)"))
#######################################################################

##################### Plotting frequency percentages. Q27_3
all$Q27_3 <- ordered(all$Q27_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q27_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q27_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q27_3merged <- rbind(x, y)
Q27_3merged$PH_or_S8 <- as.factor(Q27_3merged$PH_or_S8)
for(i in 1:length(Q27_3merged$Freq)) Q27_3merged$Freq[i] <- round(Q27_3merged$Freq[i], 2)

ggplot(Q27_3merged, aes(Q27_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Don’t trust that legal assistance will help me -\nbarrier to resolving your legal issues?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=11)", "S8 (N=46)"))
#######################################################################

##################### Plotting frequency percentages. Q27_4
all$Q27_4 <- ordered(all$Q27_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q27_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q27_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q27_4merged <- rbind(x, y)
Q27_4merged$PH_or_S8 <- as.factor(Q27_4merged$PH_or_S8)
for(i in 1:length(Q27_4merged$Freq)) Q27_4merged$Freq[i] <- round(Q27_4merged$Freq[i], 2)

ggplot(Q27_4merged, aes(Q27_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Don’t know how to effectively communicate (language barrier) -\nbarrier to resolving your legal issues?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=13)", "S8 (N=50)"))
#######################################################################

##################### Plotting frequency percentages. Q28
summary(all$Q28)
all$Q28 <- ordered(all$Q28,
                levels = c("All the members of our household are covered by adequate health insurance coverage.", "All the members of our household have health insurance coverage, but the coverage is not adequate.", "Some of the members of our household do not have health insurance coverage.", "Most of the members of our household do not have health insurance coverage.", "None of the members in our household has health insurance coverage."),
                labels = c("All  members\nadequate coverage.", "All members covered,\nbut coverage not adequate.", "Some members do not\nhave coverage.", "Most members do not\nhave coverage.", "No members\nhave coverage."))


x <- as.data.frame(prop.table(xtabs(~Q28, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q28, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q28merged <- rbind(x, y)
Q28merged$PH_or_S8 <- as.factor(Q28merged$PH_or_S8)
for(i in 1:length(Q28merged$Freq)) Q28merged$Freq[i] <- round(Q28merged$Freq[i], 2)
summary(Q28merged$Freq)

ggplot(Q28merged, aes(as.factor(Q28), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How are you and your household members\ncovered by health insurance?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=75)", "S8 (N=238)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q29
summary(all$Q29)
all$Q29 <- ordered(all$Q29,
                levels = c("Excellent", "Good", "Neutral", "Poor", "Quite poor"),
                labels = c("Excellent", "Good", "Neutral", "Poor", "Quite poor"))


x <- as.data.frame(prop.table(xtabs(~Q29, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q29, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q29merged <- rbind(x, y)
Q29merged$PH_or_S8 <- as.factor(Q29merged$PH_or_S8)
for(i in 1:length(Q29merged$Freq)) Q29merged$Freq[i] <- round(Q29merged$Freq[i], 2)
summary(Q29merged$Freq)

ggplot(Q29merged, aes(as.factor(Q29), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your current health?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=84)", "S8 (N=252)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q30_1
summary(all$Q30_1)
all$Q30_1 <- ordered(all$Q30_1,
                levels = c("Family physician", "Medical clinic", "Urgent care", "Emergency room",   "Other"),
                labels = c("Family physician", "Medical clinic", "Urgent care", "Emergency room",   "Other"))


x <- as.data.frame(prop.table(xtabs(~Q30_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q30_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q30_1merged <- rbind(x, y)
Q30_1merged$PH_or_S8 <- as.factor(Q30_1merged$PH_or_S8)
for(i in 1:length(Q30_1merged$Freq)) Q30_1merged$Freq[i] <- round(Q30_1merged$Freq[i], 2)
summary(Q30_1merged$Freq)

ggplot(Q30_1merged, aes(as.factor(Q30_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Where do you go for primary health care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=73)", "S8 (N=226)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################


##################### Plotting frequency percentages. Q31
all$Q31 <- ordered(all$Q31,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q31, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q31, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q31merged <- rbind(x, y)
Q31merged$PH_or_S8 <- as.factor(Q31merged$PH_or_S8)
for(i in 1:length(Q31merged$Freq)) Q31merged$Freq[i] <- round(Q31merged$Freq[i], 2)

ggplot(Q31merged, aes(Q31, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="During the last year, did you or any of your household members\nhave a medical problem and not go to a doctor?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=84)", "S8 (N=252)"))
#######################################################################

##################### Plotting frequency percentages. Q32
summary(all$Q32)
all$Q32 <- ordered(all$Q32,
                levels = c("Graduate degree (Master’s/Ph.D.)", "Undergraduate degree (Bachelor’s/Associate’s)", "Some college", "High school diploma or GED",   "Did not graduate from high school"),
                labels = c("Master’s/Ph.D.", "Bachelor’s/Associate’s", "Some college", "High school diploma",   "Did not graduate from high school"))


x <- as.data.frame(prop.table(xtabs(~Q32, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q32, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q32merged <- rbind(x, y)
Q32merged$PH_or_S8 <- as.factor(Q32merged$PH_or_S8)
for(i in 1:length(Q32merged$Freq)) Q32merged$Freq[i] <- round(Q32merged$Freq[i], 2)
summary(Q32merged$Freq)

ggplot(Q32merged, aes(as.factor(Q32), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="What is the highest level of education you have completed?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=80)", "S8 (N=249)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q33
summary(all$Q33)
all$Q33 <- ordered(all$Q33,
                levels = c("Yes, I got it more than a year ago", "Yes, I got it during the last year", "No, but I am planning to get it", "No, I am not planning to get it",   "No, I am not sure if I need it"),
                labels = c("Yes, I got it more than a year ago", "Yes, I got it during the last year", "No, but I am planning to get it", "No, I am not planning to get it",   "No, I am not sure if I need it"))


x <- as.data.frame(prop.table(xtabs(~Q33, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q33, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q33merged <- rbind(x, y)
Q33merged$PH_or_S8 <- as.factor(Q33merged$PH_or_S8)
for(i in 1:length(Q33merged$Freq)) Q33merged$Freq[i] <- round(Q33merged$Freq[i], 2)
summary(Q33merged$Freq)

ggplot(Q33merged, aes(as.factor(Q33), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="Do you have a vocational qualification?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 60, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=69)", "S8 (N=231)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q34
all$Q34 <- ordered(all$Q34,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q34, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q34, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q34merged <- rbind(x, y)
Q34merged$PH_or_S8 <- as.factor(Q34merged$PH_or_S8)
for(i in 1:length(Q34merged$Freq)) Q34merged$Freq[i] <- round(Q34merged$Freq[i], 2)

ggplot(Q34merged, aes(Q34, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you planning to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=76)", "S8 (N=243)"))
#######################################################################

##################### Plotting frequency percentages. Q35_1
all$Q35_1 <- ordered(all$Q35_1,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_1merged <- rbind(x, y)
Q35_1merged$PH_or_S8 <- as.factor(Q35_1merged$PH_or_S8)
for(i in 1:length(Q35_1merged$Freq)) Q35_1merged$Freq[i] <- round(Q35_1merged$Freq[i], 2)

ggplot(Q35_1merged, aes(Q35_1, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of time or energy - barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=55)", "S8 (N=217)"))
#######################################################################

##################### Plotting frequency percentages. Q35_2
all$Q35_2 <- ordered(all$Q35_2,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_2merged <- rbind(x, y)
Q35_2merged$PH_or_S8 <- as.factor(Q35_2merged$PH_or_S8)
for(i in 1:length(Q35_2merged$Freq)) Q35_2merged$Freq[i] <- round(Q35_2merged$Freq[i], 2)

ggplot(Q35_2merged, aes(Q35_2, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Cost - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=70)", "S8 (N=234)"))
#######################################################################

##################### Plotting frequency percentages. Q35_3
all$Q35_3 <- ordered(all$Q35_3,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_3merged <- rbind(x, y)
Q35_3merged$PH_or_S8 <- as.factor(Q35_3merged$PH_or_S8)
for(i in 1:length(Q35_3merged$Freq)) Q35_3merged$Freq[i] <- round(Q35_3merged$Freq[i], 2)

ggplot(Q35_3merged, aes(Q35_3, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Responsibility for children - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=60)", "S8 (N=225)"))
#######################################################################


##################### Plotting frequency percentages. Q35_4
all$Q35_4 <- ordered(all$Q35_4,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_4merged <- rbind(x, y)
Q35_4merged$PH_or_S8 <- as.factor(Q35_4merged$PH_or_S8)
for(i in 1:length(Q35_4merged$Freq)) Q35_4merged$Freq[i] <- round(Q35_4merged$Freq[i], 2)

ggplot(Q35_4merged, aes(Q35_4, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of interest/motivation - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=201)"))
#######################################################################

##################### Plotting frequency percentages. Q35_5
all$Q35_5 <- ordered(all$Q35_5,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_5merged <- rbind(x, y)
Q35_5merged$PH_or_S8 <- as.factor(Q35_5merged$PH_or_S8)
for(i in 1:length(Q35_5merged$Freq)) Q35_5merged$Freq[i] <- round(Q35_5merged$Freq[i], 2)

ggplot(Q35_5merged, aes(Q35_5, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of study skills - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=54)", "S8 (N=202)"))
#######################################################################

##################### Plotting frequency percentages. Q35_6
all$Q35_6 <- ordered(all$Q35_6,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_6merged <- rbind(x, y)
Q35_6merged$PH_or_S8 <- as.factor(Q35_6merged$PH_or_S8)
for(i in 1:length(Q35_6merged$Freq)) Q35_6merged$Freq[i] <- round(Q35_6merged$Freq[i], 2)

ggplot(Q35_6merged, aes(Q35_6, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="No place at home to study - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=47)", "S8 (N=197)"))
#######################################################################

##################### Plotting frequency percentages. Q35_7
all$Q35_7 <- ordered(all$Q35_7,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_7merged <- rbind(x, y)
Q35_7merged$PH_or_S8 <- as.factor(Q35_7merged$PH_or_S8)
for(i in 1:length(Q35_7merged$Freq)) Q35_7merged$Freq[i] <- round(Q35_7merged$Freq[i], 2)

ggplot(Q35_7merged, aes(Q35_7, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of transportation - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=45)", "S8 (N=200)"))
#######################################################################


##################### Plotting frequency percentages. Q35_8
all$Q35_8 <- ordered(all$Q35_8,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_8merged <- rbind(x, y)
Q35_8merged$PH_or_S8 <- as.factor(Q35_8merged$PH_or_S8)
for(i in 1:length(Q35_8merged$Freq)) Q35_8merged$Freq[i] <- round(Q35_8merged$Freq[i], 2)

ggplot(Q35_8merged, aes(Q35_8, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Don’t know which type of education would help get a better paying job -\na barrier for you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=53)", "S8 (N=201)"))
#######################################################################


##################### Plotting frequency percentages. Q35_9
all$Q35_9 <- ordered(all$Q35_9,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_9merged <- rbind(x, y)
Q35_9merged$PH_or_S8 <- as.factor(Q35_9merged$PH_or_S8)
for(i in 1:length(Q35_9merged$Freq)) Q35_9merged$Freq[i] <- round(Q35_9merged$Freq[i], 2)

ggplot(Q35_9merged, aes(Q35_9, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Lack of English proficiency - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=71)", "S8 (N=203)"))
#######################################################################

##################### Plotting frequency percentages. Q35_10
all$Q35_10 <- ordered(all$Q35_10,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_10, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_10, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_10merged <- rbind(x, y)
Q35_10merged$PH_or_S8 <- as.factor(Q35_10merged$PH_or_S8)
for(i in 1:length(Q35_10merged$Freq)) Q35_10merged$Freq[i] <- round(Q35_10merged$Freq[i], 2)

ggplot(Q35_10merged, aes(Q35_10, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Personal or family issues - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=49)", "S8 (N=203)"))
#######################################################################

##################### Plotting frequency percentages. Q35_11
all$Q35_11 <- ordered(all$Q35_11,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_11, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_11, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_11merged <- rbind(x, y)
Q35_11merged$PH_or_S8 <- as.factor(Q35_11merged$PH_or_S8)
for(i in 1:length(Q35_11merged$Freq)) Q35_11merged$Freq[i] <- round(Q35_11merged$Freq[i], 2)

ggplot(Q35_11merged, aes(Q35_11, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Health issues - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=52)", "S8 (N=200)"))
#######################################################################


##################### Plotting frequency percentages. Q35_12
all$Q35_12 <- ordered(all$Q35_12,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q35_12, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q35_12, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q35_12merged <- rbind(x, y)
Q35_12merged$PH_or_S8 <- as.factor(Q35_12merged$PH_or_S8)
for(i in 1:length(Q35_12merged$Freq)) Q35_12merged$Freq[i] <- round(Q35_12merged$Freq[i], 2)

ggplot(Q35_12merged, aes(Q35_12, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Immigration status - a barrier\nfor you to advance your education or skills?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=63)", "S8 (N=201)"))
#######################################################################

##################### Plotting frequency percentages. Q36_1

summary(all$Q36_1)
all$Q36_1 <- ordered(all$Q36_1,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_1, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_1, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_1merged <- rbind(x, y)
Q36_1merged$PH_or_S8 <- as.factor(Q36_1merged$PH_or_S8)
for(i in 1:length(Q36_1merged$Freq)) Q36_1merged$Freq[i] <- round(Q36_1merged$Freq[i], 2)
summary(Q36_1merged)

ggplot(Q36_1merged, aes(as.factor(Q36_1), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Housing?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=72)", "S8 (N=229)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q36_2

summary(all$Q36_2)
all$Q36_2 <- ordered(all$Q36_2,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_2, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_2, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_2merged <- rbind(x, y)
Q36_2merged$PH_or_S8 <- as.factor(Q36_2merged$PH_or_S8)
for(i in 1:length(Q36_2merged$Freq)) Q36_2merged$Freq[i] <- round(Q36_2merged$Freq[i], 2)
summary(Q36_2merged)

ggplot(Q36_2merged, aes(as.factor(Q36_2), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Employment?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=70)", "S8 (N=222)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q36_3

summary(all$Q36_3)
all$Q36_3 <- ordered(all$Q36_3,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_3, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_3, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_3merged <- rbind(x, y)
Q36_3merged$PH_or_S8 <- as.factor(Q36_3merged$PH_or_S8)
for(i in 1:length(Q36_3merged$Freq)) Q36_3merged$Freq[i] <- round(Q36_3merged$Freq[i], 2)
summary(Q36_3merged)

ggplot(Q36_3merged, aes(as.factor(Q36_3), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Income?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=69)", "S8 (N=234)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q36_4

summary(all$Q36_4)
all$Q36_4 <- ordered(all$Q36_4,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_4, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_4, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_4merged <- rbind(x, y)
Q36_4merged$PH_or_S8 <- as.factor(Q36_4merged$PH_or_S8)
for(i in 1:length(Q36_4merged$Freq)) Q36_4merged$Freq[i] <- round(Q36_4merged$Freq[i], 2)
summary(Q36_4merged)

ggplot(Q36_4merged, aes(as.factor(Q36_4), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Food?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=66)", "S8 (N=232)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q36_5

summary(all$Q36_5)
all$Q36_5 <- ordered(all$Q36_5,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_5, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_5, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_5merged <- rbind(x, y)
Q36_5merged$PH_or_S8 <- as.factor(Q36_5merged$PH_or_S8)
for(i in 1:length(Q36_5merged$Freq)) Q36_5merged$Freq[i] <- round(Q36_5merged$Freq[i], 2)
summary(Q36_5merged)

ggplot(Q36_5merged, aes(as.factor(Q36_5), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Transportation?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=60)", "S8 (N=229)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages Q36_6 . 

summary(all$Q36_6)
all$Q36_6 <- ordered(all$Q36_6,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_6, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_6, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_6merged <- rbind(x, y)
Q36_6merged$PH_or_S8 <- as.factor(Q36_6merged$PH_or_S8)
for(i in 1:length(Q36_6merged$Freq)) Q36_6merged$Freq[i] <- round(Q36_6merged$Freq[i], 2)
summary(Q36_6merged)

ggplot(Q36_6merged, aes(as.factor(Q36_6), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Child care?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=34)", "S8 (N=158)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages Q36_7 . 

summary(all$Q36_7)
all$Q36_7 <- ordered(all$Q36_7,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_7, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_7, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_7merged <- rbind(x, y)
Q36_7merged$PH_or_S8 <- as.factor(Q36_7merged$PH_or_S8)
for(i in 1:length(Q36_7merged$Freq)) Q36_7merged$Freq[i] <- round(Q36_7merged$Freq[i], 2)
summary(Q36_7merged)

ggplot(Q36_7merged, aes(as.factor(Q36_7), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Support networks?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=45)", "S8 (N=192)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages Q36_8 . 

summary(all$Q36_8)
all$Q36_8 <- ordered(all$Q36_8,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_8, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_8, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_8merged <- rbind(x, y)
Q36_8merged$PH_or_S8 <- as.factor(Q36_8merged$PH_or_S8)
for(i in 1:length(Q36_8merged$Freq)) Q36_8merged$Freq[i] <- round(Q36_8merged$Freq[i], 2)
summary(Q36_8merged)

ggplot(Q36_8merged, aes(as.factor(Q36_8), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Legal issues?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=36)", "S8 (N=127)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################


##################### Plotting frequency percentages Q36_9 . 

summary(all$Q36_9)
all$Q36_9 <- ordered(all$Q36_9,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_9, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_9, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_9merged <- rbind(x, y)
Q36_9merged$PH_or_S8 <- as.factor(Q36_9merged$PH_or_S8)
for(i in 1:length(Q36_9merged$Freq)) Q36_9merged$Freq[i] <- round(Q36_9merged$Freq[i], 2)
summary(Q36_9merged)

ggplot(Q36_9merged, aes(as.factor(Q36_9), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Health?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=61)", "S8 (N=210)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################


##################### Plotting frequency percentages Q36_10 . 

summary(all$Q36_10)
all$Q36_10 <- ordered(all$Q36_10,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_10, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_10, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_10merged <- rbind(x, y)
Q36_10merged$PH_or_S8 <- as.factor(Q36_10merged$PH_or_S8)
for(i in 1:length(Q36_10merged$Freq)) Q36_10merged$Freq[i] <- round(Q36_10merged$Freq[i], 2)
summary(Q36_10merged)

ggplot(Q36_10merged, aes(as.factor(Q36_10), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Education?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=59)", "S8 (N=203)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages Q36_11 . 

summary(all$Q36_11)
all$Q36_11 <- ordered(all$Q36_11,
                levels = c("Urgent situation, currently in crisis", "Vulnerable, need support to move forward", "Safe, family is making progress towards stability", "Stable, family is stable, safe and moving towards thriving", "Thriving, family is self-sufficient and thriving"),
                labels = c("Currently in crisis", "Vulnerable", "Safe", "Stable", "Thriving"))


x <- as.data.frame(prop.table(xtabs(~Q36_11, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q36_11, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q36_11merged <- rbind(x, y)
Q36_11merged$PH_or_S8 <- as.factor(Q36_11merged$PH_or_S8)
for(i in 1:length(Q36_11merged$Freq)) Q36_11merged$Freq[i] <- round(Q36_11merged$Freq[i], 2)
summary(Q36_11merged)

ggplot(Q36_11merged, aes(as.factor(Q36_11), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="How would you rate your situation in terms of Immigration status?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=51)", "S8 (N=72)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages Q37 . 

summary(all$Q37)
all$Q37 <- ordered(all$Q37,
                levels = c("American Indian or Alaska Native", "Asian", "Black or African American", "Native Hawaiian or Other Pacific Islander", "White", "Other"),
                labels = c("American Indian", "Asian", "African American", "Pacific Islander", "White", "Other"))


x <- as.data.frame(prop.table(xtabs(~Q37, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q37, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q37merged <- rbind(x, y)
Q37merged$PH_or_S8 <- as.factor(Q37merged$PH_or_S8)
for(i in 1:length(Q37merged$Freq)) Q37merged$Freq[i] <- round(Q37merged$Freq[i], 2)
summary(Q37merged)

ggplot(Q37merged, aes(as.factor(Q37), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="What is your race?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=59)", "S8 (N=203)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################

##################### Plotting frequency percentages. Q38
all$Q38 <- ordered(all$Q38,
                levels = c("Yes", "No"),
                labels = c("Yes", "No"))

x <- as.data.frame(prop.table(xtabs(~Q38, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q38, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q38merged <- rbind(x, y)
Q38merged$PH_or_S8 <- as.factor(Q38merged$PH_or_S8)
for(i in 1:length(Q38merged$Freq)) Q38merged$Freq[i] <- round(Q38merged$Freq[i], 2)

ggplot(Q38merged, aes(Q38, Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge', width=.5) + labs(x="", y="Percent (%)", title="Are you Hispanic or Latino?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=0.5), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, hjust = 0.5, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=83)", "S8 (N=226)"))
#######################################################################

##################### Plotting frequency percentages Q39 . 

summary(all$Q39)
all$Q39 <- ordered(all$Q39,
                levels = c("English", "English and Spanish", "Spanish"),
                labels = c("English", "English and Spanish", "Spanish"))


x <- as.data.frame(prop.table(xtabs(~Q39, data=subset(all, PH_or_S8=="PH")))*100)
y <- as.data.frame(prop.table(xtabs(~Q39, data=subset(all, PH_or_S8=="S8")))*100)

x$PH_or_S8 <- "PH"
y$PH_or_S8 <- "S8"

Q39merged <- rbind(x, y)
Q39merged$PH_or_S8 <- as.factor(Q39merged$PH_or_S8)
for(i in 1:length(Q39merged$Freq)) Q39merged$Freq[i] <- round(Q39merged$Freq[i], 2)
summary(Q39merged)

ggplot(Q39merged, aes(as.factor(Q39), Freq, fill=PH_or_S8)) + geom_bar(stat='identity', position='dodge') + labs(x="", y="Percent (%)", title="What is the primary language used in your home?") + 
  geom_text(aes(label=round(Freq, 0)), position=position_dodge(width=1), vjust=1.25, colour="white", size = 7) + 
  theme(
    plot.title = element_text(size=20, face="bold", vjust=3, color="#000033"), 
    axis.text.x = element_text(size=18, angle = 45, hjust = 1, color="#000033"), 
    axis.text.y = element_text(size=18), 
    axis.title.x = element_text(color="#000033", size=18), 
    axis.title.y = element_text(color="#000033", size=18, vjust=2),
    legend.title=element_blank(),
    legend.text = element_text(colour="#000033", size = 18)
    ) +
  scale_fill_manual(values = c("#000030", "#51153255"), name="",
                         breaks=c("PH", "S8"),
                         labels=c("PH (N=83)", "S8 (N=244)")) 

summary(subset(all, PH_or_S8=="PH"))
                                                                                                                                                                                                          
#######################################################################






```

